
var sayATM={oddTracker:-1,zoneTracker:0,adZones:[],adTemplates:[],varData:{},adsConfig:{},adsPriority:{},tpl_lyra:function(o,p){console.log("lyra template called: "+o.adZones[p]+" and "+o.lyra);sayATM.addDashTag(o.adZones[p],o.lyra)},tpl_contentAdTiles:function(o,p){var t=String(new Date().getTime());t=t.substring(t.length-5,t.length);sayATM.insertHTML(o.adZones[p],'<div id="gridContainer" class="say-flexGrid" style="position:relative; width:300px; padding-bottom:5px; margin:0;"><div id="adGrid-pos1" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos2" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos3" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos4" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos5" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos6" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos7" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos8" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos9" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: none;"></div><div id="bottomClearDiv" style="clear:both;"></div></div>');sayATM.addDashTag("adGrid-pos1",o.ad1,t);sayATM.addDashTag("adGrid-pos2",o.ad2,t);sayATM.addDashTag("adGrid-pos3",o.ad3,t);sayATM.addDashTag("adGrid-pos4",o.ad4,t);sayATM.addDashTag("adGrid-pos5",o.ad5,t);sayATM.addDashTag("adGrid-pos6",o.ad6,t);sayATM.addDashTag("adGrid-pos7",o.ad7,t);sayATM.addDashTag("adGrid-pos8",o.ad8,t);sayATM.addDashTag("adGrid-pos9",o.ad9,t+1,1);sayATM.selectAdsChained()},tpl_contentAdTiles4:function(o,p){var t=String(new Date().getTime());t=t.substring(t.length-5,t.length);sayATM.insertHTML(o.adZones[p],'<div id="gridContainer" class="say-flexGrid" style="position:relative; width:300px; padding-bottom:5px; margin:0;"><div id="adGrid-pos1" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos2" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos3" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos4" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos5" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="bottomClearDiv" style="clear:both;"></div></div>');sayATM.addDashTag("adGrid-pos1",o.ad1,t);sayATM.addDashTag("adGrid-pos2",o.ad2,t);sayATM.addDashTag("adGrid-pos3",o.ad3,t);sayATM.addDashTag("adGrid-pos4",o.ad4,t);sayATM.addDashTag("adGrid-pos5",o.ad5,t+1,1);sayATM.selectAdsChained()},tpl_streamAdTiles:function(o,p){var t=String(new Date().getTime());var fixWidth="100%";t=t.substring(t.length-5,t.length);console.log(o.adZones[p]+" | "+p);sayATM.insertHTML(o.adZones[p],'<div id="gridContainer" class="say-flexGrid" style="position:relative; width:'+fixWidth+'px; padding-bottom:5px; margin:0;"><div id="adGrid-pos1" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos2" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos3" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos4" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos5" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos6" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos7" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos8" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: block;"></div><div id="adGrid-pos9" class="say-tile-unit" style="position:relative; width: 140px; height: 150px; margin: 5px 0 0 5px; float: left; display: none;"></div><div id="bottomClearDiv" style="clear:both;"></div></div>');sayATM.addDashTag("adGrid-pos1",o.ad1,t);sayATM.addDashTag("adGrid-pos2",o.ad2,t);sayATM.addDashTag("adGrid-pos3",o.ad3,t);sayATM.addDashTag("adGrid-pos4",o.ad4,t);sayATM.addDashTag("adGrid-pos5",o.ad5,t);sayATM.addDashTag("adGrid-pos6",o.ad6,t);sayATM.addDashTag("adGrid-pos7",o.ad7,t);sayATM.addDashTag("adGrid-pos8",o.ad8,t);sayATM.addDashTag("adGrid-pos9",o.ad9,t+1,1);sayATM.selectAdsChained()},regView:function(rUrl){var e=document.createElement("img");e.width=0;e.height=0;e.src=rUrl;document.getElementsByTagName("body")[0].appendChild(e)},parseCustomVars:function(customVars,adsConfig,adsPriority,regUrl){console.log("customVars[0] = "+customVars[0]);var zones=customVars[0].split("~");sayATM.adZones=zones;var tmpArr=customVars[1].split("~");var pData={};for(var m=0;m<tmpArr.length;m++){var keyVal=tmpArr[m].split(":");if(keyVal[1]!=undefined){pData[keyVal[0].toLowerCase()]=keyVal[0].toLowerCase()+"_"+keyVal[1].replace(/[\-]/g,"").toLowerCase()}else{pData[keyVal[0].toLowerCase()]=keyVal[0].toLowerCase()}}sayATM.varData={adZones:zones,pageData:pData};if(adsConfig!=undefined&&adsPriority!=undefined){sayATM.adsConfig=adsConfig;sayATM.adsPriority=adsPriority}if(regUrl!=undefined){sayATM.selectAdsChained(regUrl)}else{sayATM.selectAdsChained()}},selectAds:function(varData,adsConfig,adsPriority,regUrl){var adLoaded;for(var d=0;d<sayATM.adZones.length;d++){adLoaded=false;if(sayATM.adZones[d].toLowerCase()=="x"){continue}for(var c=0;c<adsPriority.length;c++){var targetData=varData.pageData[adsPriority[c]];if(targetData!="undefined"&&adsConfig[d][targetData]!=undefined){sayATM.setupAds(adsConfig[d][targetData],varData,d);adLoaded=true;break}}if(!adLoaded){sayATM.setupAds(adsConfig[d]["ros"],varData,d)}}if(regUrl!=undefined){sayATM.regView(regUrl)}else{}},selectAdsChained:function(regUrl){var adLoaded;var targetData;console.log(">>enter selectAdsChained: "+sayATM.zoneTracker);if(sayATM.zoneTracker>=sayATM.adZones.length){return}adLoaded=false;if(sayATM.adZones[sayATM.zoneTracker].toLowerCase()=="x"){sayATM.zoneTracker=sayATM.zoneTracker+1;sayATM.selectAdsChained()}else{for(var c=0;c<sayATM.adsPriority.length;c++){targetData=sayATM.varData.pageData[sayATM.adsPriority[c]];if(targetData!="undefined"&&sayATM.adsConfig[sayATM.zoneTracker][targetData]!=undefined){console.log(">>found target");adLoaded=true;break}}if(!adLoaded){console.log(">>default target");targetData="ros"}sayATM.zoneTracker=sayATM.zoneTracker+1;if(regUrl!=undefined){sayATM.regView(regUrl)}else{}sayATM.setupAds(sayATM.adsConfig[sayATM.zoneTracker-1][targetData],sayATM.varData,sayATM.zoneTracker-1)}},setupAds:function(sovArr,varData,pos){var pArr=new Array();for(var c=0;c<sovArr.length;c++){for(var i=0;i<sovArr[c]["p"];i++){pArr.push(c)}}var idx=Math.floor(Math.random()*pArr.length);var sel=sovArr[pArr[idx]];sel.adZones=varData.adZones;var tpl=this[sel.e];if(typeof(tpl)==="function"){sayATM.adTemplates[pos]=[];sayATM.adTemplates[pos][0]=tpl;sayATM.adTemplates[pos][1]=sel;tpl(sel,pos)}else{console.log("TEMPLATED FUNCTION IS NOT DEFINED")}},addCustomTag:function(tag,divId){var x=document.getElementById(divId);var y=document.createElement("iframe");y.scrolling="no";y.width="300";y.height="250";y.style.border="none";y.style.margin="0 0 0 0";y.style.top="0";y.style.left="0";x.appendChild(y);var z=(y.contentWindow||y.contentDocument);var content='<html><head><title>ad frame</title></head><body><script type="text/javascript" src="'+tag+'"><\/script></body></html>';z.contents=content;y.src='javascript:window["contents"]'},addDashTag:function(divId,aid,gid,trigger,src){var t=document.getElementById(divId);var s1;var s2;var scr;if(typeof(src)==="undefined"){src="ads.saymedia.com"}if(document.location.href.indexOf("nullsweat")!=-1){src="stage.ads.saymedia.com"}if(typeof(gid)==="undefined"){gid=null}if(typeof(trigger)==="undefined"){trigger=null}if(gid!=null){s1=document.createElement("script");scr="var grp_"+aid+'=";grp='+gid+'"';s1.async=true;s1.text=scr;t.appendChild(s1)}s2=document.createElement("script");s2.async=true;s2.src="http://"+src+"/"+aid+".js?placement_whitelist=0&ord="+Math.random();t.appendChild(s2);console.log("sayATM:add dash tag to page");if(trigger!=null){setTimeout(function(){sayATM.handleShowHouseAd(divId)},4000)}},setStyle:function(divId,styles){var styleObj=document.getElementById(divId).style;for(var key in styles){styleObj[key]=styles[key]}},insertHTML:function(divId,str){if(document.getElementById(divId)){console.log("inserting html into: "+divId);document.getElementById(divId).innerHTML+=str}else{console.log(divId+" not found in page")}},clearSponsor:function(){this.setStyle("page-header",{backgroundImage:"none"})},collapseAdContainer:function(divId){document.getElementById(divId).style.display="none"},handleNoAd:function(divNum,mode){var element=document.getElementById("adGrid-pos"+Number(divNum));if(mode==1){element&&element.parentNode&&element.parentNode.removeChild(element);sayATM.oddTracker*=-1}else{if(mode==2){document.getElementById("content-stream-ad-pos"+Number(divNum)).style.display="none"}}},handleShowHouseAd:function(divId){var element=document.getElementById(divId);if(sayATM.oddTracker>0){element.style.display="block"}else{element&&element.parentNode&&element.parentNode.removeChild(element)}}};var sayReloader={totalCount:0,maxReloads:1000,minReloadTimeMs:1000,lastReloadTime:[],TimeToFade:500,reloadAd:function(adzone){var rightNow,thisProd,scriptTags,tagUrl,newScriptElt;rightNow=new Date().getTime();for(thisProd in veprods){if(veprods[thisProd].takeovershowing){return}}if((sayReloader.totalCount>=sayReloader.maxReloads)||((typeof sayReloader.lastReloadTime[adzone]!="undefined")&&(rightNow-sayReloader.lastReloadTime[adzone]<sayReloader.minReloadTimeMs))){return}sayReloader.fade(adzone);sayReloader.totalCount++;sayReloader.lastReloadTime[adzone]=rightNow},fade:function(adzone){var element=document.getElementById(sayATM.adZones[adzone]);if(element==null){return}if(element.FadeState==null){if(element.style.opacity==null||element.style.opacity==""||element.style.opacity=="1"){element.FadeState=2}else{element.FadeState=-2}}if(element.FadeState==1||element.FadeState==-1){element.FadeState=element.FadeState==1?-1:1;element.FadeTimeLeft=sayReloader.TimeToFade-element.FadeTimeLeft}else{element.FadeState=element.FadeState==2?-1:1;element.FadeTimeLeft=sayReloader.TimeToFade;setTimeout("sayReloader.animateFade("+new Date().getTime()+",'"+adzone+"')",33)}},animateFade:function(lastTick,adzone){var curTick=new Date().getTime();var elapsedTicks=curTick-lastTick;var element=document.getElementById(sayATM.adZones[adzone]);var oldAdDiv;if(element.FadeTimeLeft<=elapsedTicks){element.style.opacity=element.FadeState==1?"1":"0";element.style.filter="alpha(opacity = "+(element.FadeState==1?"100":"0")+")";element.FadeState=element.FadeState==1?2:-2;if(element.FadeState==-2){oldAdDiv=document.getElementById(sayATM.adZones[adzone]);while(oldAdDiv.childNodes.length){oldAdDiv.removeChild(oldAdDiv.childNodes[0])}sayATM.adTemplates[adzone][0](sayATM.adTemplates[adzone][1],adzone);setTimeout("sayReloader.fade('"+adzone+"')",500)}return}element.FadeTimeLeft-=elapsedTicks;var newOpVal=element.FadeTimeLeft/sayReloader.TimeToFade;if(element.FadeState==1){newOpVal=1-newOpVal}element.style.opacity=newOpVal;element.style.filter="alpha(opacity = "+(newOpVal*100)+")";setTimeout("sayReloader.animateFade("+curTick+",'"+adzone+"')",33)}};var handleNoAd=sayATM.handleNoAd;

(function() {
    "use strict";

    ////     VARIABLES     ////
    var localTesting = false;
    var adsPriority = [ "series", "section", "type", "tag" ];
    var regUrl = "https://adserver.adtechus.com/adcount/3.0/5108/2766669/0/16/AdId=4047765;BnId=6;ct=1009463179;st=1811;adcid=1;itime=782390627;reqtype=25;";
    var varData;
    var pathname = document.location.pathname;
    var page_url = document.location.href;
    var customVars = [];
    var defaultVars = [];
    /////////////////////


    ////     DEFAULT DIV IDS AND SECTION     ////
    defaultVars[0] = "x~x~x~x~x";
    defaultVars[1] = "ROS";
    //customVars[1] = "section:diy-remodeling";
    /////////////////////////////



    ////     URL/PAGE TARGETING     ////
    if(pathname == "/toc" || pathname == "/2011/09/02/siemens_helps_torture_a_new_generation_in_bahrain" || pathname == "/2011/09/08/siemens_helps_bahraini_torturers_this_week_in_onli")
    {
        customVars[0] = "X~X~X~X~X";
        customVars[1] = "series:ghirardelli1";
        AdInstantiater.getInstance().hideAds();
    }else if(page_url.indexOf("http://readwrite.com/2013/09/09/instagram-150-million-users-ads-coming-next-year") != -1)
    {
        customVars[0] = "lyra_lite~lyra_lite~X~X~X";
        customVars[1] = "series:acerstripe";
    }else if(page_url.indexOf("http://readwrite.com/2013/09/06/amazon-free-smartphone-sell-your-soul") != -1)
    {
        customVars[0] = "lyra~X~X~X~X";
        customVars[1] = "series:acerfull";
    }else if ( page_url.indexOf("http://readwrite.com/2014/01/13/personal-cloud-wd-mycloud-sponsored") != -1 ) {
        customVars[0] = "lyra_lite~X~X~X~X";
        customVars[1] = "series:mycloud";
    } else if(page_url.indexOf("http://readwrite.com/2013/12/11/braun-cooltec-shaver-sponsored") != -1)
    {
        customVars[0] = "lyra~X~X~X~X";
        customVars[1] = "series:cooltec";
    } else if ( page_url.indexOf("/series/drive") != -1 ) {
        customVars[0] = "lyra~X~X~X~X";
        customVars[1] = "series:generalmotors25491";
    } else if ( page_url.indexOf("/series/body") != -1 ) {
        customVars[0] = "lyra~X~X~X~X";
        customVars[1] = "series:qualcomm24396";
    } else if ( page_url.indexOf("readwrite.com/cloud") != -1 ) {
        customVars[0] = "X~lyra_lite~X~X~X";
        customVars[1] = "series:vmware";
    } else if ( page_url.indexOf("http://readwrite.com/2014/01/03/qualcomm-toq-smartwatch-review") != -1 ) {
        customVars[0] = "X~X~X~X~X";
    }
    /////////////////////////////


    ////     ADS SETUP     ////
    var fullscreen_aid = "ai016768a15fba970b0192aaafd293970d";
    var stripe_aid = "ai016768a15fba970b0192aaafd342970d";

    if(document.location.href.indexOf("iwantads") != -1)
    {
        fullscreen_aid = "ai017c344dcc79970b019b008e6762970d";
        stripe_aid = "ai017c344dcc79970b019b008e15fb970c";
    }
    if(document.location.href.indexOf("iwantstripeads") != -1)
    {
        fullscreen_aid = "ai017c344dcc79970b019b008e15fb970c";
        stripe_aid = "ai017c344dcc79970b019b008e15fb970c";
    }
    var adsConfig = [];
    adsConfig[0] = {
        // ROS - This definition is the minimum required for a Site's Ad definition
        ros:[
            {  "p":"100", "e":"tpl_lyra", "lyra": fullscreen_aid }
        ],
      series_acerfull:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b0192aaafc335970d" }
        ],
      series_acerstripe:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b0192aaafc3ec970d" }
        ],
        series_generalmotors25491:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b019b02211726970c" }
        ],
        series_drive:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b019b02211726970c" }
        ],
        series_qualcomm24396:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b019b022249ae970d" }
        ],
        series_body:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b019b022249ae970d" }
        ],
        series_cooltec:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b019b0214a221970b" }
        ],
        series_americanexpressopenforum:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b01a3fac20d6d970b" }
        ],
        series_mycloud:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b01a510b261e0970c" }
        ],
        section_cloud:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b01a51160ab43970c" }
        ]
    }; //Lyra
    adsConfig[1] = {
        ros:[
            {  "p":"100", "e":"tpl_lyra", "lyra": stripe_aid }
        ],
        section_cloud:[
            {   "p":"100","e":"tpl_lyra", "lyra":"ai016768a15fba970b01a51160ab43970c" }
        ],
        series_acerstripe:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b0192aaafc3ec970d" }
        ],
        series_generalmotors25491:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b019b02211726970c" }
        ],
        series_drive:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b019b02211726970c" }
        ],
        series_qualcomm24396:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b019b022249ae970d" }
        ],
        series_body:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b019b022249ae970d" }
        ],
        series_cooltec:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b019b0214a221970b" }
        ],
        series_americanexpressopenforum:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b01a3fac20d6d970b" }
        ],
        series_mycloud:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b01a510b261e0970c" }
        ],
        series_vmware:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b01a51160ab43970c" }
        ],
        series_hearwhatsnext: [
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b01a73d7586ac970d" }
        ],
        series_riseofthevisualweb:[
            {  "p":"100", "e":"tpl_lyra", "lyra": "ai016768a15fba970b01a511751ab4970c" }
        ]
    }; //Lyra Lite
    adsConfig[2] = {
        ros:[
            {  "p": "100", "e": "tpl_contentAdTiles",   "ad1":"ai01675ec23943970b017c341cab84970b",
                                                        "ad2":"ai01675ec23943970b017d3e4b8576970c",
                                                        "ad3":"ai01675ec23943970b017d3e4b8616970c",
                                                        "ad4":"ai01675ec23943970b017ee5c05694970d",
                                                        "ad5":"ai01675ec23943970b017d3e4b8edb970c",
                                                        "ad6":"ai01675ec23943970b017d3e4b8f64970c",
                                                        "ad7":"ai01675ec23943970b017c341cb69c970b",
                                                        "ad8":"ai01675ec23943970b017d3e4b90e8970c",
                                                        "ad9":"ai01675ec23943970b017ee86edcea970d" }
        ]
    }; //Vertical 8 Grid
    adsConfig[3] = {
        ros:[
            {  "p": "100", "e": "tpl_streamAdTiles",   "ad1":"ai01675ec23943970b017c341cab84970b",
                                                        "ad2":"ai01675ec23943970b017d3e4b8576970c",
                                                        "ad3":"ai01675ec23943970b017d3e4b8616970c",
                                                        "ad4":"ai01675ec23943970b017ee5c05694970d",
                                                        "ad5":"ai01675ec23943970b017d3e4b8edb970c",
                                                        "ad6":"ai01675ec23943970b017d3e4b8f64970c",
                                                        "ad7":"ai01675ec23943970b017c341cb69c970b",
                                                        "ad8":"ai01675ec23943970b017d3e4b90e8970c",
                                                        "ad9":"ai01675ec23943970b017ee86edcea970d"}
        ]
    }; //Horizontal 8 Grid
    adsConfig[4] = {
        ros:[
            {  "p": "0", "e": "tpl_contentAdTiles4",    "ad1":"ai01675ec23943970b017c341cab84970b",
                                                        "ad2":"ai01675ec23943970b017d3e4b8576970c",
                                                        "ad3":"ai01675ec23943970b017d3e4b8616970c",
                                                        "ad4":"ai01675ec23943970b017ee5c05694970d",
                                                        "ad5":"ai01675ec23943970b017ee86edcea970d" }
        ]
    }; //4 Grid
    /////////////////////////////




    //// INIT - DO NOT TOUCH BELOW HERE ////
     if(localTesting){
        var urlParams = {};
        getParams();
        customVars[0] = ((urlParams["sub1"] == undefined) ? defaultVars[0] : urlParams["sub1"]);
        customVars[1] = ((urlParams["sub2"] == undefined) ? defaultVars[1] : urlParams["sub2"]);
        customVars[2] = ((urlParams["sub3"] == undefined) ? defaultVars[2] : urlParams["sub3"]);
        customVars[3] = ((urlParams["sub4"] == undefined) ? defaultVars[3] : urlParams["sub4"]);

        regUrl = "javascript:void(0);";
    }else{
        if(customVars[0] == undefined)
        {
            customVars[0] = "x~lyra_lite~x~x~x";
            customVars[0] = ((customVars[0] == "" || "_ADSUB1" + "_" == "x~lyra_lite~x~x~x") ? defaultVars[0] : "x~lyra_lite~x~x~x");
        }
        if(customVars[1] == undefined)
        {
            customVars[1] = "section:hack";
            customVars[1] = ((customVars[1] == "" || "_ADSUB2" + "_" == "section:hack") ? defaultVars[1] : "section:hack");
        }
        customVars[2] = "";
        customVars[2] = ((customVars[2] == "" || "_ADSUB3" + "_" == "") ? defaultVars[2] : "");
        customVars[3] = "";
        customVars[3] = ((customVars[3] == "" || "_ADSUB4" + "_" == "") ? defaultVars[3] : "");
    }

    function getParams(){  //temp

        var match,
            pl     = /\+/g,  // Regex for replacing addition symbol with a space
            search = /([^&=]+)=?([^&]*)/g,
            decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
            query  = window.location.search.substring(1);

        while (match = search.exec(query))
           urlParams[decode(match[1])] = decode(match[2]);
    }

    function sayAdInit(){
        console.log("sayATM:startup");
        sayATM.parseCustomVars(customVars, adsConfig, adsPriority);
    }

    if(page_url.indexOf("hotfuzz") != -1)
    {
        var ele1 = document.createElement("div");
        var ele2 = document.createElement("div");
        var ele3 = document.createElement("p");
        ele1.id = 'gabeDiv1';
        ele2.id = 'gabeDiv2';
        var myScript1 = document.createElement("script");
        var myScript2 = document.createElement("script");
        myScript1.src = "http://ads.saymedia.com/ai017c34b791df970b017c34b7a161970b.js?ord="+ Math.random();
        myScript1.type = "text/javascript";
        myScript2.src = "http://ads.saymedia.com/ai0168e8148b37970c019b0275a528970c.js?ord="+ Math.random();
        myScript2.type = "text/javascript";
        ele1.appendChild(myScript1);
        ele2.appendChild(myScript2);
        if(document.getElementsByClassName("copy instapaper_body")[0] != null)
        {
            document.getElementsByClassName("copy instapaper_body")[0].getElementsByTagName("p")[Math.round(document.getElementsByClassName("copy instapaper_body")[0].getElementsByTagName("p").length - 1)].appendChild(ele3);
            document.getElementsByClassName("copy instapaper_body")[0].getElementsByTagName("p")[Math.round(document.getElementsByClassName("copy instapaper_body")[0].getElementsByTagName("p").length - 1)].appendChild(ele1);
        }
        document.getElementsByTagName("body")[0].appendChild(ele2);
    }
    
    sayAdInit();
})();