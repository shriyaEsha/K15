/*! ReadWriteWeb - v1.1.1 - 2013-09-25 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(b){var e,f=b||window.event,g=[].slice.call(arguments,1),h=0,i=0,j=0,k=0,l=0;return b=a.event.fix(f),b.type="mousewheel",f.wheelDelta&&(h=f.wheelDelta),f.detail&&(h=-1*f.detail),f.deltaY&&(j=-1*f.deltaY,h=j),f.deltaX&&(i=f.deltaX,h=-1*i),void 0!==f.wheelDeltaY&&(j=f.wheelDeltaY),void 0!==f.wheelDeltaX&&(i=-1*f.wheelDeltaX),k=Math.abs(h),(!c||c>k)&&(c=k),l=Math.max(Math.abs(j),Math.abs(i)),(!d||d>l)&&(d=l),e=h>0?"floor":"ceil",h=Math[e](h/c),i=Math[e](i/d),j=Math[e](j/d),g.unshift(b,h,i,j),(a.event.dispatch||a.event.handle).apply(this,g)}var c,d,e=["wheel","mousewheel","DOMMouseScroll"],f="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];if(a.event.fixHooks)for(var g=e.length;g;)a.event.fixHooks[e[--g]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=f.length;a;)this.addEventListener(f[--a],b,!1);else this.onmousewheel=b},teardown:function(){if(this.removeEventListener)for(var a=f.length;a;)this.removeEventListener(f[--a],b,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}),function(a,b,c){a.fn.jScrollPane=function(d){function e(d,e){function f(b){var e,h,j,l,m,n,q=!1,r=!1;if(P=b,Q===c)m=d.scrollTop(),n=d.scrollLeft(),d.css({overflow:"hidden",padding:0}),R=d.innerWidth()+tb,S=d.innerHeight(),d.width(R),Q=a('<div class="jspPane" />').css("padding",sb).append(d.children()),T=a('<div class="jspContainer" />').css({width:R+"px",height:S+"px"}).append(Q).appendTo(d);else{if(d.css("width",""),q=P.stickToBottom&&C(),r=P.stickToRight&&D(),l=d.innerWidth()+tb!=R||d.outerHeight()!=S,l&&(R=d.innerWidth()+tb,S=d.innerHeight(),T.css({width:R+"px",height:S+"px"})),!l&&ub==U&&Q.outerHeight()==V)return d.width(R),void 0;ub=U,Q.css("width",""),d.width(R),T.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}Q.css("overflow","auto"),U=b.contentWidth?b.contentWidth:Q[0].scrollWidth,V=Q[0].scrollHeight,Q.css("overflow",""),W=U/R,X=V/S,Y=X>1,Z=W>1,Z||Y?(d.addClass("jspScrollable"),e=P.maintainPosition&&(ab||db),e&&(h=A(),j=B()),g(),i(),k(),e&&(y(r?U-R:h,!1),x(q?V-S:j,!1)),H(),E(),N(),P.enableKeyboardNavigation&&J(),P.clickOnTrack&&o(),L(),P.hijackInternalLinks&&M()):(d.removeClass("jspScrollable"),Q.css({top:0,width:T.width()-tb}),F(),I(),K(),p()),P.autoReinitialise&&!rb?rb=setInterval(function(){f(P)},P.autoReinitialiseDelay):!P.autoReinitialise&&rb&&clearInterval(rb),m&&d.scrollTop(0)&&x(m,!1),n&&d.scrollLeft(0)&&y(n,!1),d.trigger("jsp-initialised",[Z||Y])}function g(){Y&&(T.append(a('<div class="jspVerticalBar" />').append(a('<div class="jspCap jspCapTop" />'),a('<div class="jspTrack" />').append(a('<div class="jspDrag" />').append(a('<div class="jspDragTop" />'),a('<div class="jspDragBottom" />'))),a('<div class="jspCap jspCapBottom" />'))),eb=T.find(">.jspVerticalBar"),fb=eb.find(">.jspTrack"),$=fb.find(">.jspDrag"),P.showArrows&&(jb=a('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",m(0,-1)).bind("click.jsp",G),kb=a('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",m(0,1)).bind("click.jsp",G),P.arrowScrollOnHover&&(jb.bind("mouseover.jsp",m(0,-1,jb)),kb.bind("mouseover.jsp",m(0,1,kb))),l(fb,P.verticalArrowPositions,jb,kb)),hb=S,T.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){hb-=a(this).outerHeight()}),$.hover(function(){$.addClass("jspHover")},function(){$.removeClass("jspHover")}).bind("mousedown.jsp",function(b){a("html").bind("dragstart.jsp selectstart.jsp",G),$.addClass("jspActive");var c=b.pageY-$.position().top;return a("html").bind("mousemove.jsp",function(a){r(a.pageY-c,!1)}).bind("mouseup.jsp mouseleave.jsp",q),!1}),h())}function h(){fb.height(hb+"px"),ab=0,gb=P.verticalGutter+fb.outerWidth(),Q.width(R-gb-tb);try{0===eb.position().left&&Q.css("margin-left",gb+"px")}catch(a){}}function i(){Z&&(T.append(a('<div class="jspHorizontalBar" />').append(a('<div class="jspCap jspCapLeft" />'),a('<div class="jspTrack" />').append(a('<div class="jspDrag" />').append(a('<div class="jspDragLeft" />'),a('<div class="jspDragRight" />'))),a('<div class="jspCap jspCapRight" />'))),lb=T.find(">.jspHorizontalBar"),mb=lb.find(">.jspTrack"),bb=mb.find(">.jspDrag"),P.showArrows&&(pb=a('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",m(-1,0)).bind("click.jsp",G),qb=a('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",m(1,0)).bind("click.jsp",G),P.arrowScrollOnHover&&(pb.bind("mouseover.jsp",m(-1,0,pb)),qb.bind("mouseover.jsp",m(1,0,qb))),l(mb,P.horizontalArrowPositions,pb,qb)),bb.hover(function(){bb.addClass("jspHover")},function(){bb.removeClass("jspHover")}).bind("mousedown.jsp",function(b){a("html").bind("dragstart.jsp selectstart.jsp",G),bb.addClass("jspActive");var c=b.pageX-bb.position().left;return a("html").bind("mousemove.jsp",function(a){t(a.pageX-c,!1)}).bind("mouseup.jsp mouseleave.jsp",q),!1}),nb=T.innerWidth(),j())}function j(){T.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){nb-=a(this).outerWidth()}),mb.width(nb+"px"),db=0}function k(){if(Z&&Y){var b=mb.outerHeight(),c=fb.outerWidth();hb-=b,a(lb).find(">.jspCap:visible,>.jspArrow").each(function(){nb+=a(this).outerWidth()}),nb-=c,S-=c,R-=b,mb.parent().append(a('<div class="jspCorner" />').css("width",b+"px")),h(),j()}Z&&Q.width(T.outerWidth()-tb+"px"),V=Q.outerHeight(),X=V/S,Z&&(ob=Math.ceil(1/W*nb),ob>P.horizontalDragMaxWidth?ob=P.horizontalDragMaxWidth:ob<P.horizontalDragMinWidth&&(ob=P.horizontalDragMinWidth),bb.width(ob+"px"),cb=nb-ob,u(db)),Y&&(ib=Math.ceil(1/X*hb),ib>P.verticalDragMaxHeight?ib=P.verticalDragMaxHeight:ib<P.verticalDragMinHeight&&(ib=P.verticalDragMinHeight),$.height(ib+"px"),_=hb-ib,s(ab))}function l(a,b,c,d){var e,f="before",g="after";"os"==b&&(b=/Mac/.test(navigator.platform)?"after":"split"),b==f?g=b:b==g&&(f=b,e=c,c=d,d=e),a[f](c)[g](d)}function m(a,b,c){return function(){return n(a,b,this,c),this.blur(),!1}}function n(b,c,d,e){d=a(d).addClass("jspActive");var f,g,h=!0,i=function(){0!==b&&vb.scrollByX(b*P.arrowButtonSpeed),0!==c&&vb.scrollByY(c*P.arrowButtonSpeed),g=setTimeout(i,h?P.initialDelay:P.arrowRepeatFreq),h=!1};i(),f=e?"mouseout.jsp":"mouseup.jsp",e=e||a("html"),e.bind(f,function(){d.removeClass("jspActive"),g&&clearTimeout(g),g=null,e.unbind(f)})}function o(){p(),Y&&fb.bind("mousedown.jsp",function(b){if(b.originalTarget===c||b.originalTarget==b.currentTarget){var d,e=a(this),f=e.offset(),g=b.pageY-f.top-ab,h=!0,i=function(){var a=e.offset(),c=b.pageY-a.top-ib/2,f=S*P.scrollPagePercent,k=_*f/(V-S);if(0>g)ab-k>c?vb.scrollByY(-f):r(c);else{if(!(g>0))return j(),void 0;c>ab+k?vb.scrollByY(f):r(c)}d=setTimeout(i,h?P.initialDelay:P.trackClickRepeatFreq),h=!1},j=function(){d&&clearTimeout(d),d=null,a(document).unbind("mouseup.jsp",j)};return i(),a(document).bind("mouseup.jsp",j),!1}}),Z&&mb.bind("mousedown.jsp",function(b){if(b.originalTarget===c||b.originalTarget==b.currentTarget){var d,e=a(this),f=e.offset(),g=b.pageX-f.left-db,h=!0,i=function(){var a=e.offset(),c=b.pageX-a.left-ob/2,f=R*P.scrollPagePercent,k=cb*f/(U-R);if(0>g)db-k>c?vb.scrollByX(-f):t(c);else{if(!(g>0))return j(),void 0;c>db+k?vb.scrollByX(f):t(c)}d=setTimeout(i,h?P.initialDelay:P.trackClickRepeatFreq),h=!1},j=function(){d&&clearTimeout(d),d=null,a(document).unbind("mouseup.jsp",j)};return i(),a(document).bind("mouseup.jsp",j),!1}})}function p(){mb&&mb.unbind("mousedown.jsp"),fb&&fb.unbind("mousedown.jsp")}function q(){a("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),$&&$.removeClass("jspActive"),bb&&bb.removeClass("jspActive")}function r(a,b){Y&&(0>a?a=0:a>_&&(a=_),b===c&&(b=P.animateScroll),b?vb.animate($,"top",a,s):($.css("top",a),s(a)))}function s(a){a===c&&(a=$.position().top),T.scrollTop(0),ab=a;var b=0===ab,e=ab==_,f=a/_,g=-f*(V-S);(wb!=b||yb!=e)&&(wb=b,yb=e,d.trigger("jsp-arrow-change",[wb,yb,xb,zb])),v(b,e),Q.css("top",g),d.trigger("jsp-scroll-y",[-g,b,e]).trigger("scroll")}function t(a,b){Z&&(0>a?a=0:a>cb&&(a=cb),b===c&&(b=P.animateScroll),b?vb.animate(bb,"left",a,u):(bb.css("left",a),u(a)))}function u(a){a===c&&(a=bb.position().left),T.scrollTop(0),db=a;var b=0===db,e=db==cb,f=a/cb,g=-f*(U-R);(xb!=b||zb!=e)&&(xb=b,zb=e,d.trigger("jsp-arrow-change",[wb,yb,xb,zb])),w(b,e),Q.css("left",g),d.trigger("jsp-scroll-x",[-g,b,e]).trigger("scroll")}function v(a,b){P.showArrows&&(jb[a?"addClass":"removeClass"]("jspDisabled"),kb[b?"addClass":"removeClass"]("jspDisabled"))}function w(a,b){P.showArrows&&(pb[a?"addClass":"removeClass"]("jspDisabled"),qb[b?"addClass":"removeClass"]("jspDisabled"))}function x(a,b){var c=a/(V-S);r(c*_,b)}function y(a,b){var c=a/(U-R);t(c*cb,b)}function z(b,c,d){var e,f,g,h,i,j,k,l,m,n=0,o=0;try{e=a(b)}catch(p){return}for(f=e.outerHeight(),g=e.outerWidth(),T.scrollTop(0),T.scrollLeft(0);!e.is(".jspPane");)if(n+=e.position().top,o+=e.position().left,e=e.offsetParent(),/^body|html$/i.test(e[0].nodeName))return;h=B(),j=h+S,h>n||c?l=n-P.verticalGutter:n+f>j&&(l=n-S+f+P.verticalGutter),l&&x(l,d),i=A(),k=i+R,i>o||c?m=o-P.horizontalGutter:o+g>k&&(m=o-R+g+P.horizontalGutter),m&&y(m,d)}function A(){return-Q.position().left}function B(){return-Q.position().top}function C(){var a=V-S;return a>20&&a-B()<10}function D(){var a=U-R;return a>20&&a-A()<10}function E(){T.unbind(Bb).bind(Bb,function(a,b,c,d){var e=db,f=ab;return vb.scrollBy(c*P.mouseWheelSpeed,-d*P.mouseWheelSpeed,!1),e==db&&f==ab})}function F(){T.unbind(Bb)}function G(){return!1}function H(){Q.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(a){z(a.target,!1)})}function I(){Q.find(":input,a").unbind("focus.jsp")}function J(){function b(){var a=db,b=ab;switch(c){case 40:vb.scrollByY(P.keyboardSpeed,!1);break;case 38:vb.scrollByY(-P.keyboardSpeed,!1);break;case 34:case 32:vb.scrollByY(S*P.scrollPagePercent,!1);break;case 33:vb.scrollByY(-S*P.scrollPagePercent,!1);break;case 39:vb.scrollByX(P.keyboardSpeed,!1);break;case 37:vb.scrollByX(-P.keyboardSpeed,!1)}return e=a!=db||b!=ab}var c,e,f=[];Z&&f.push(lb[0]),Y&&f.push(eb[0]),Q.focus(function(){d.focus()}),d.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(d){if(d.target===this||f.length&&a(d.target).closest(f).length){var g=db,h=ab;switch(d.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:c=d.keyCode,b();break;case 35:x(V-S),c=null;break;case 36:x(0),c=null}return e=d.keyCode==c&&g!=db||h!=ab,!e}}).bind("keypress.jsp",function(a){return a.keyCode==c&&b(),!e}),P.hideFocus?(d.css("outline","none"),"hideFocus"in T[0]&&d.attr("hideFocus",!0)):(d.css("outline",""),"hideFocus"in T[0]&&d.attr("hideFocus",!1))}function K(){d.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function L(){if(location.hash&&location.hash.length>1){var b,c,d=escape(location.hash.substr(1));try{b=a("#"+d+', a[name="'+d+'"]')}catch(e){return}b.length&&Q.find(d)&&(0===T.scrollTop()?c=setInterval(function(){T.scrollTop()>0&&(z(b,!0),a(document).scrollTop(T.position().top),clearInterval(c))},50):(z(b,!0),a(document).scrollTop(T.position().top)))}}function M(){a(document.body).data("jspHijack")||(a(document.body).data("jspHijack",!0),a(document.body).delegate("a[href*=#]","click",function(c){var d,e,f,g,h,i,j=this.href.substr(0,this.href.indexOf("#")),k=location.href;if(-1!==location.href.indexOf("#")&&(k=location.href.substr(0,location.href.indexOf("#"))),j===k){d=escape(this.href.substr(this.href.indexOf("#")+1));try{e=a("#"+d+', a[name="'+d+'"]')}catch(l){return}e.length&&(f=e.closest(".jspScrollable"),g=f.data("jsp"),g.scrollToElement(e,!0),f[0].scrollIntoView&&(h=a(b).scrollTop(),i=e.offset().top,(h>i||i>h+a(b).height())&&f[0].scrollIntoView()),c.preventDefault())}}))}function N(){var a,b,c,d,e,f=!1;T.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(g){var h=g.originalEvent.touches[0];a=A(),b=B(),c=h.pageX,d=h.pageY,e=!1,f=!0}).bind("touchmove.jsp",function(g){if(f){var h=g.originalEvent.touches[0],i=db,j=ab;return vb.scrollTo(a+c-h.pageX,b+d-h.pageY),e=e||Math.abs(c-h.pageX)>5||Math.abs(d-h.pageY)>5,i==db&&j==ab}}).bind("touchend.jsp",function(){f=!1}).bind("click.jsp-touchclick",function(){return e?(e=!1,!1):void 0})}function O(){var a=B(),b=A();d.removeClass("jspScrollable").unbind(".jsp"),d.replaceWith(Ab.append(Q.children())),Ab.scrollTop(a),Ab.scrollLeft(b),rb&&clearInterval(rb)}var P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb=this,wb=!0,xb=!0,yb=!1,zb=!1,Ab=d.clone(!1,!1).empty(),Bb=a.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";sb=d.css("paddingTop")+" "+d.css("paddingRight")+" "+d.css("paddingBottom")+" "+d.css("paddingLeft"),tb=(parseInt(d.css("paddingLeft"),10)||0)+(parseInt(d.css("paddingRight"),10)||0),a.extend(vb,{reinitialise:function(b){b=a.extend({},P,b),f(b)},scrollToElement:function(a,b,c){z(a,b,c)},scrollTo:function(a,b,c){y(a,c),x(b,c)},scrollToX:function(a,b){y(a,b)},scrollToY:function(a,b){x(a,b)},scrollToPercentX:function(a,b){y(a*(U-R),b)},scrollToPercentY:function(a,b){x(a*(V-S),b)},scrollBy:function(a,b,c){vb.scrollByX(a,c),vb.scrollByY(b,c)},scrollByX:function(a,b){var c=A()+Math[0>a?"floor":"ceil"](a),d=c/(U-R);t(d*cb,b)},scrollByY:function(a,b){var c=B()+Math[0>a?"floor":"ceil"](a),d=c/(V-S);r(d*_,b)},positionDragX:function(a,b){t(a,b)},positionDragY:function(a,b){r(a,b)},animate:function(a,b,c,d){var e={};e[b]=c,a.animate(e,{duration:P.animateDuration,easing:P.animateEase,queue:!1,step:d})},getContentPositionX:function(){return A()},getContentPositionY:function(){return B()},getContentWidth:function(){return U},getContentHeight:function(){return V},getPercentScrolledX:function(){return A()/(U-R)},getPercentScrolledY:function(){return B()/(V-S)},getIsScrollableH:function(){return Z},getIsScrollableV:function(){return Y},getContentPane:function(){return Q},scrollToBottom:function(a){r(_,a)},hijackInternalLinks:a.noop,destroy:function(){O()}}),f(e)}return d=a.extend({},a.fn.jScrollPane.defaults,d),a.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){d[this]=d[this]||d.speed}),this.each(function(){var b=a(this),c=b.data("jsp");c?c.reinitialise(d):(a("script",b).filter('[type="text/javascript"],:not([type])').remove(),c=new e(b,d),b.data("jsp",c))})},a.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:c,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}}(jQuery,this),window.JSON||(window.JSON={}),function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)d=rep[c],"string"==typeof d&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var JSON=window.JSON,cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(a,b){"use strict";var c=a.History=a.History||{},d=a.jQuery;if("undefined"!=typeof c.Adapter)throw new Error("History.js Adapter has already been loaded...");c.Adapter={bind:function(a,b,c){d(a).bind(b,c)},trigger:function(a,b,c){d(a).trigger(b,c)},extractEventData:function(a,c,d){var e=c&&c.originalEvent&&c.originalEvent[a]||d&&d[a]||b;return e},onDomLoad:function(a){d(a)}},"undefined"!=typeof c.init&&c.init()}(window),function(a,b){"use strict";var c=a.console||b,d=a.document,e=a.navigator,f=a.sessionStorage||!1,g=a.setTimeout,h=a.clearTimeout,i=a.setInterval,j=a.clearInterval,k=a.JSON,l=a.alert,m=a.History=a.History||{},n=a.history;if(k.stringify=k.stringify||k.encode,k.parse=k.parse||k.decode,"undefined"!=typeof m.init)throw new Error("History.js Core has already been loaded...");m.init=function(){return"undefined"==typeof m.Adapter?!1:("undefined"!=typeof m.initCore&&m.initCore(),"undefined"!=typeof m.initHtml4&&m.initHtml4(),!0)},m.initCore=function(){if("undefined"!=typeof m.initCore.initialized)return!1;if(m.initCore.initialized=!0,m.options=m.options||{},m.options.hashChangeInterval=m.options.hashChangeInterval||100,m.options.safariPollInterval=m.options.safariPollInterval||500,m.options.doubleCheckInterval=m.options.doubleCheckInterval||500,m.options.storeInterval=m.options.storeInterval||1e3,m.options.busyDelay=m.options.busyDelay||250,m.options.debug=m.options.debug||!1,m.options.initialTitle=m.options.initialTitle||d.title,m.intervalList=[],m.clearAllIntervals=function(){var a,b=m.intervalList;if("undefined"!=typeof b&&null!==b){for(a=0;a<b.length;a++)j(b[a]);m.intervalList=null}},m.debug=function(){m.options.debug&&m.log.apply(m,arguments)},m.log=function(){var a,b,e,f,g,h=!("undefined"==typeof c||"undefined"==typeof c.log||"undefined"==typeof c.log.apply),i=d.getElementById("log");for(h?(f=Array.prototype.slice.call(arguments),a=f.shift(),"undefined"!=typeof c.debug?c.debug.apply(c,[a,f]):c.log.apply(c,[a,f])):a="\n"+arguments[0]+"\n",b=1,e=arguments.length;e>b;++b){if(g=arguments[b],"object"==typeof g&&"undefined"!=typeof k)try{g=k.stringify(g)}catch(j){}a+="\n"+g+"\n"}return i?(i.value+=a+"\n-----\n",i.scrollTop=i.scrollHeight-i.clientHeight):h||l(a),!0},m.getInternetExplorerMajorVersion=function(){var a=m.getInternetExplorerMajorVersion.cached="undefined"!=typeof m.getInternetExplorerMajorVersion.cached?m.getInternetExplorerMajorVersion.cached:function(){for(var a=3,b=d.createElement("div"),c=b.getElementsByTagName("i");(b.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->")&&c[0];);return a>4?a:!1}();return a},m.isInternetExplorer=function(){var a=m.isInternetExplorer.cached="undefined"!=typeof m.isInternetExplorer.cached?m.isInternetExplorer.cached:Boolean(m.getInternetExplorerMajorVersion());return a},m.emulated={pushState:!Boolean(a.history&&a.history.pushState&&a.history.replaceState&&!(/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(e.userAgent)||/AppleWebKit\/5([0-2]|3[0-2])/i.test(e.userAgent))),hashChange:Boolean(!("onhashchange"in a||"onhashchange"in d)||m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8)},m.enabled=!m.emulated.pushState,m.bugs={setHash:Boolean(!m.emulated.pushState&&"Apple Computer, Inc."===e.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),safariPoll:Boolean(!m.emulated.pushState&&"Apple Computer, Inc."===e.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),ieDoubleCheck:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<7)},m.isEmptyObject=function(a){for(var b in a)return!1;return!0},m.cloneObject=function(a){var b,c;return a?(b=k.stringify(a),c=k.parse(b)):c={},c},m.getRootUrl=function(){var a=d.location.protocol+"//"+(d.location.hostname||d.location.host);return d.location.port&&(a+=":"+d.location.port),a+="/"},m.getBaseHref=function(){var a=d.getElementsByTagName("base"),b=null,c="";return 1===a.length&&(b=a[0],c=b.href.replace(/[^\/]+$/,"")),c=c.replace(/\/+$/,""),c&&(c+="/"),c},m.getBaseUrl=function(){var a=m.getBaseHref()||m.getBasePageUrl()||m.getRootUrl();return a},m.getPageUrl=function(){var a,b=m.getState(!1,!1),c=(b||{}).url||d.location.href;return a=c.replace(/\/+$/,"").replace(/[^\/]+$/,function(a){return/\./.test(a)?a:a+"/"})},m.getBasePageUrl=function(){var a=d.location.href.replace(/[#\?].*/,"").replace(/[^\/]+$/,function(a){return/[^\/]$/.test(a)?"":a}).replace(/\/+$/,"")+"/";return a},m.getFullUrl=function(a,b){var c=a,d=a.substring(0,1);return b="undefined"==typeof b?!0:b,/[a-z]+\:\/\//.test(a)||(c="/"===d?m.getRootUrl()+a.replace(/^\/+/,""):"#"===d?m.getPageUrl().replace(/#.*/,"")+a:"?"===d?m.getPageUrl().replace(/[\?#].*/,"")+a:b?m.getBaseUrl()+a.replace(/^(\.\/)+/,""):m.getBasePageUrl()+a.replace(/^(\.\/)+/,"")),c.replace(/\#$/,"")},m.getShortUrl=function(a){var b=a,c=m.getBaseUrl(),d=m.getRootUrl();return m.emulated.pushState&&(b=b.replace(c,"")),b=b.replace(d,"/"),m.isTraditionalAnchor(b)&&(b="./"+b),b=b.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},m.store={},m.idToState=m.idToState||{},m.stateToId=m.stateToId||{},m.urlToId=m.urlToId||{},m.storedStates=m.storedStates||[],m.savedStates=m.savedStates||[],m.normalizeStore=function(){m.store.idToState=m.store.idToState||{},m.store.urlToId=m.store.urlToId||{},m.store.stateToId=m.store.stateToId||{}},m.getState=function(a,b){"undefined"==typeof a&&(a=!0),"undefined"==typeof b&&(b=!0);var c=m.getLastSavedState();return!c&&b&&(c=m.createStateObject()),a&&(c=m.cloneObject(c),c.url=c.cleanUrl||c.url),c},m.getIdByState=function(a){var b,c=m.extractId(a.url);if(!c)if(b=m.getStateString(a),"undefined"!=typeof m.stateToId[b])c=m.stateToId[b];else if("undefined"!=typeof m.store.stateToId[b])c=m.store.stateToId[b];else{for(;;)if(c=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),"undefined"==typeof m.idToState[c]&&"undefined"==typeof m.store.idToState[c])break;m.stateToId[b]=c,m.idToState[c]=a}return c},m.normalizeState=function(a){var b,c;return a&&"object"==typeof a||(a={}),"undefined"!=typeof a.normalized?a:(a.data&&"object"==typeof a.data||(a.data={}),b={},b.normalized=!0,b.title=a.title||"",b.url=m.getFullUrl(m.unescapeString(a.url||d.location.href)),b.hash=m.getShortUrl(b.url),b.data=m.cloneObject(a.data),b.id=m.getIdByState(b),b.cleanUrl=b.url.replace(/\??\&_suid.*/,""),b.url=b.cleanUrl,c=!m.isEmptyObject(b.data),(b.title||c)&&(b.hash=m.getShortUrl(b.url).replace(/\??\&_suid.*/,""),/\?/.test(b.hash)||(b.hash+="?"),b.hash+="&_suid="+b.id),b.hashedUrl=m.getFullUrl(b.hash),(m.emulated.pushState||m.bugs.safariPoll)&&m.hasUrlDuplicate(b)&&(b.url=b.hashedUrl),b)},m.createStateObject=function(a,b,c){var d={data:a,title:b,url:c};return d=m.normalizeState(d)},m.getStateById=function(a){a=String(a);var c=m.idToState[a]||m.store.idToState[a]||b;return c},m.getStateString=function(a){var b,c,d;return b=m.normalizeState(a),c={data:b.data,title:a.title,url:a.url},d=k.stringify(c)},m.getStateId=function(a){var b,c;return b=m.normalizeState(a),c=b.id},m.getHashByState=function(a){var b,c;return b=m.normalizeState(a),c=b.hash},m.extractId=function(a){var b,c,d;return c=/(.*)\&_suid=([0-9]+)$/.exec(a),d=c?c[1]||a:a,b=c?String(c[2]||""):"",b||!1},m.isTraditionalAnchor=function(a){var b=!/[\/\?\.]/.test(a);return b},m.extractState=function(a,b){var c,d,e=null;return b=b||!1,c=m.extractId(a),c&&(e=m.getStateById(c)),e||(d=m.getFullUrl(a),c=m.getIdByUrl(d)||!1,c&&(e=m.getStateById(c)),e||!b||m.isTraditionalAnchor(a)||(e=m.createStateObject(null,null,d))),e},m.getIdByUrl=function(a){var c=m.urlToId[a]||m.store.urlToId[a]||b;return c},m.getLastSavedState=function(){return m.savedStates[m.savedStates.length-1]||b},m.getLastStoredState=function(){return m.storedStates[m.storedStates.length-1]||b},m.hasUrlDuplicate=function(a){var b,c=!1;return b=m.extractState(a.url),c=b&&b.id!==a.id},m.storeState=function(a){return m.urlToId[a.url]=a.id,m.storedStates.push(m.cloneObject(a)),a},m.isLastSavedState=function(a){var b,c,d,e=!1;return m.savedStates.length&&(b=a.id,c=m.getLastSavedState(),d=c.id,e=b===d),e},m.saveState=function(a){return m.isLastSavedState(a)?!1:(m.savedStates.push(m.cloneObject(a)),!0)},m.getStateByIndex=function(a){var b=null;return b="undefined"==typeof a?m.savedStates[m.savedStates.length-1]:0>a?m.savedStates[m.savedStates.length+a]:m.savedStates[a]},m.getHash=function(){var a=m.unescapeHash(d.location.hash);return a},m.unescapeString=function(b){for(var c,d=b;;){if(c=a.unescape(d),c===d)break;d=c}return d},m.unescapeHash=function(a){var b=m.normalizeHash(a);return b=m.unescapeString(b)},m.normalizeHash=function(a){var b=a.replace(/#.*/,"");return b},m.setHash=function(a,b){var c,e,f;return b!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.setHash,args:arguments,queue:b}),!1):(c=m.escapeHash(a),m.busy(!0),e=m.extractState(a,!0),e&&!m.emulated.pushState?m.pushState(e.data,e.title,e.url,!1):d.location.hash!==c&&(m.bugs.setHash?(f=m.getPageUrl(),m.pushState(null,null,f+"#"+c,!1)):d.location.hash=c),m)},m.escapeHash=function(b){var c=m.normalizeHash(b);return c=a.escape(c),m.bugs.hashEscape||(c=c.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),c},m.getHashByUrl=function(a){var b=String(a).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return b=m.unescapeHash(b)},m.setTitle=function(a){var b,c=a.title;c||(b=m.getStateByIndex(0),b&&b.url===a.url&&(c=b.title||m.options.initialTitle));try{d.getElementsByTagName("title")[0].innerHTML=c.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(e){}return d.title=c,m},m.queues=[],m.busy=function(a){if("undefined"!=typeof a?m.busy.flag=a:"undefined"==typeof m.busy.flag&&(m.busy.flag=!1),!m.busy.flag){h(m.busy.timeout);var b=function(){var a,c,d;if(!m.busy.flag)for(a=m.queues.length-1;a>=0;--a)c=m.queues[a],0!==c.length&&(d=c.shift(),m.fireQueueItem(d),m.busy.timeout=g(b,m.options.busyDelay))};m.busy.timeout=g(b,m.options.busyDelay)}return m.busy.flag},m.busy.flag=!1,m.fireQueueItem=function(a){return a.callback.apply(a.scope||m,a.args||[])},m.pushQueue=function(a){return m.queues[a.queue||0]=m.queues[a.queue||0]||[],m.queues[a.queue||0].push(a),m},m.queue=function(a,b){return"function"==typeof a&&(a={callback:a}),"undefined"!=typeof b&&(a.queue=b),m.busy()?m.pushQueue(a):m.fireQueueItem(a),m},m.clearQueue=function(){return m.busy.flag=!1,m.queues=[],m},m.stateChanged=!1,m.doubleChecker=!1,m.doubleCheckComplete=function(){return m.stateChanged=!0,m.doubleCheckClear(),m},m.doubleCheckClear=function(){return m.doubleChecker&&(h(m.doubleChecker),m.doubleChecker=!1),m},m.doubleCheck=function(a){return m.stateChanged=!1,m.doubleCheckClear(),m.bugs.ieDoubleCheck&&(m.doubleChecker=g(function(){return m.doubleCheckClear(),m.stateChanged||a(),!0},m.options.doubleCheckInterval)),m},m.safariStatePoll=function(){var b,c=m.extractState(d.location.href);if(!m.isLastSavedState(c))return b=c,b||(b=m.createStateObject()),m.Adapter.trigger(a,"popstate"),m},m.back=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.back,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.back(!1)}),n.go(-1),!0)},m.forward=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.forward,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.forward(!1)}),n.go(1),!0)},m.go=function(a,b){var c;if(a>0)for(c=1;a>=c;++c)m.forward(b);else{if(!(0>a))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(c=-1;c>=a;--c)m.back(b)}return m},m.emulated.pushState){var o=function(){};m.pushState=m.pushState||o,m.replaceState=m.replaceState||o}else m.onPopState=function(b,c){var e,f,g=!1,h=!1;return m.doubleCheckComplete(),(e=m.getHash())?(f=m.extractState(e||d.location.href,!0),f?m.replaceState(f.data,f.title,f.url,!1):(m.Adapter.trigger(a,"anchorchange"),m.busy(!1)),m.expectedStateId=!1,!1):(g=m.Adapter.extractEventData("state",b,c)||!1,h=g?m.getStateById(g):m.expectedStateId?m.getStateById(m.expectedStateId):m.extractState(d.location.href),h||(h=m.createStateObject(null,d.title,d.location.href)),m.expectedStateId=!1,m.isLastSavedState(h)?(m.busy(!1),!1):(m.storeState(h),m.saveState(h),m.setTitle(h),m.Adapter.trigger(a,"statechange"),m.busy(!1),!0))},m.Adapter.bind(a,"popstate",m.onPopState),m.pushState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.pushState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.pushState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0},m.replaceState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.replaceState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.replaceState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0};if(f){try{m.store=k.parse(f.getItem("History.store"))||{}}catch(p){m.store={}}m.normalizeStore()}else m.store={},m.normalizeStore();m.Adapter.bind(a,"beforeunload",m.clearAllIntervals),m.Adapter.bind(a,"unload",m.clearAllIntervals),m.saveState(m.storeState(m.extractState(d.location.href,!0))),f&&(m.onUnload=function(){var a,b;try{a=k.parse(f.getItem("History.store"))||{}}catch(c){a={}}a.idToState=a.idToState||{},a.urlToId=a.urlToId||{},a.stateToId=a.stateToId||{};for(b in m.idToState)m.idToState.hasOwnProperty(b)&&(a.idToState[b]=m.idToState[b]);for(b in m.urlToId)m.urlToId.hasOwnProperty(b)&&(a.urlToId[b]=m.urlToId[b]);
for(b in m.stateToId)m.stateToId.hasOwnProperty(b)&&(a.stateToId[b]=m.stateToId[b]);m.store=a,m.normalizeStore(),f.setItem("History.store",k.stringify(a))},m.intervalList.push(i(m.onUnload,m.options.storeInterval)),m.Adapter.bind(a,"beforeunload",m.onUnload),m.Adapter.bind(a,"unload",m.onUnload)),m.emulated.pushState||(m.bugs.safariPoll&&m.intervalList.push(i(m.safariStatePoll,m.options.safariPollInterval)),("Apple Computer, Inc."===e.vendor||"Mozilla"===(e.appCodeName||""))&&(m.Adapter.bind(a,"hashchange",function(){m.Adapter.trigger(a,"popstate")}),m.getHash()&&m.Adapter.onDomLoad(function(){m.Adapter.trigger(a,"hashchange")})))},m.init()}(window),function(a){"use strict";var b="undefined"==typeof Zepto?a({}):a("<b/>");a.subscribe=function(){b.on.apply(b,arguments)},a.unsubscribe=function(){b.off.apply(b,arguments)},a.publish=function(){b.trigger.apply(b,arguments)}}($),function(a){"use strict";a.fn.fitVids=function(b){var c={customSelector:null},d=document.createElement("div"),e=document.getElementsByTagName("base")[0]||document.getElementsByTagName("script")[0];return d.className="fit-vids-style",d.innerHTML="&shy;<style>               .fluid-width-video-wrapper {                 width: 100%;                              position: relative;                       padding: 0;                            }                                                                                   .fluid-width-video-wrapper iframe,        .fluid-width-video-wrapper object,        .fluid-width-video-wrapper embed {           position: absolute;                       top: 0;                                   left: 0;                                  width: 100%;                              height: 100%;                          }                                       </style>",e.parentNode.insertBefore(d,e),b&&a.extend(c,b),this.each(function(){var b=["iframe[src*='player.vimeo.com']","iframe[src*='www.youtube.com']","iframe[src*='www.youtube-nocookie.com']","iframe[src*='www.kickstarter.com']","object","embed"];c.customSelector&&b.push(c.customSelector);var d=a(this).find(b.join(","));d.each(function(){var b=a(this);if(!("embed"===this.tagName.toLowerCase()&&b.parent("object").length||b.parent(".fluid-width-video-wrapper").length)){var c="object"===this.tagName.toLowerCase()||b.attr("height")&&!isNaN(parseInt(b.attr("height"),10))?parseInt(b.attr("height"),10):b.height(),d=isNaN(parseInt(b.attr("width"),10))?b.width():parseInt(b.attr("width"),10),e=c/d;if(!b.attr("id")){var f="fitvid"+Math.floor(999999*Math.random());b.attr("id",f)}b.wrap('<div class="fluid-width-video-wrapper"></div>').parent(".fluid-width-video-wrapper").css("padding-top",100*e+"%"),b.removeAttr("height").removeAttr("width")}})})}}(jQuery),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(a){return a}function c(a){return decodeURIComponent(a.replace(e," "))}function d(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return f.json?JSON.parse(a):a}catch(b){}}var e=/\+/g,f=a.cookie=function(e,g,h){if(void 0!==g){if(h=a.extend({},f.defaults,h),"number"==typeof h.expires){var i=h.expires,j=h.expires=new Date;j.setDate(j.getDate()+i)}return g=f.json?JSON.stringify(g):String(g),document.cookie=[f.raw?e:encodeURIComponent(e),"=",f.raw?g:encodeURIComponent(g),h.expires?"; expires="+h.expires.toUTCString():"",h.path?"; path="+h.path:"",h.domain?"; domain="+h.domain:"",h.secure?"; secure":""].join("")}for(var k=f.raw?b:c,l=document.cookie.split("; "),m=e?void 0:{},n=0,o=l.length;o>n;n++){var p=l[n].split("="),q=k(p.shift()),r=k(p.join("="));if(e&&e===q){m=d(r);break}e||(m[q]=d(r))}return m};f.defaults={},a.removeCookie=function(b,c){return void 0!==a.cookie(b)?(a.cookie(b,"",a.extend({},c,{expires:-1})),!0):!1}}),function(a){function b(a){function b(b,c){return c=c.replace(/<!--([\s\S]*?)-->/g,"$1").replace(/<!\[CDATA\[([\s\S]*?)\]\]>/g,"$1"),a.chars&&a.chars(c),""}function c(c){for(c=v+c,v=c,o.debug.parse&&console.log("PARSE parseMore",c);c;){if(r=!0,t||u.last()&&n[u.last()]){t=!1;var h=new RegExp("([\\s\\S]*?)</"+u.last()+"[^>]*>","i");if(!c.match(h))return t=!0,w;c=c.replace(h,b),e("",u.last())}else if(0===c.indexOf("<!--")?(q=c.indexOf("-->"),q>=0&&(o.debug.parse&&console.log("PARSE comment",s),a.comment&&a.comment(c.substring(4,q)),c=c.substring(q+3),r=!1)):0===c.indexOf("</")?(s=c.match(g),s&&(o.debug.parse&&console.log("PARSE end tag",s),c=c.substring(s[0].length),s[0].replace(g,e),r=!1)):0===c.indexOf("<")&&(s=c.match(f),s&&(o.debug.parse&&console.log("PARSE start tag",s),c=c.substring(s[0].length),s[0].replace(f,d),r=!1)),r){q=c.indexOf("<");var i=0>q?c:c.substring(0,q);c=0>q?"":c.substring(q),o.debug.parse&&console.log("PARSE chars",i),a.chars&&a.chars(i)}var j=c==v;if(v=c,j)break}return o.debug.parse&&console.log("PARSE end parse"),w}function d(b,c,d,f){if(c=c.toLowerCase(),j[c])for(;u.last()&&k[u.last()];)e("",u.last());if(l[c]&&u.last()==c&&e("",c),f=i[c]||!!f,f||u.push(c),a.start){var g=[];d.replace(h,function(a,b){var c=arguments[2]?arguments[2]:arguments[3]?arguments[3]:arguments[4]?arguments[4]:m[b]?b:"";g.push({name:b,value:c,escaped:c.replace(/(^|[^\\])"/g,'$1\\"')})}),a.start&&a.start(c,g,f)}}function e(b,c){o.debug.parse&&console.log("PARSE parseEndTag",b,c);var d;if(c)for(d=u.length-1;d>=0&&u[d]!=c;d--);else d=0;if(d>=0){for(var e=u.length-1;e>=d;e--)a.end&&a.end(u[e]);o.debug.parse&&console.log("PARSE parseEndTag pop",u.slice(d)),u.length=d}}function p(a){a&&c(a),e()}var q,r,s,t,u=[],v="";u.last=function(){return this[this.length-1]};var w={parseMore:c,end:p};return w}function c(a,c){function d(a){return c[a]?c[a].apply(c,e(arguments,1).concat([f()])):void 0}function f(){return{stack:h}}c=c||{};var g=a,h=[g],i=a.ownerDocument||a.getOwnerDocument&&a.getOwnerDocument();h.last=function(){return this[this.length-1]},h.pop=function(){var a=Array.prototype.pop.call(this);return g=this.last(),a},h.push=function(a){Array.prototype.push.call(this,a),g=a};var j,k=b(j={start:function(a,b,c){if(d("start",a,b,c)!==!1){o.debug.write&&console.log("WRITE start",a,b,c);for(var e=i.createElement(a),f=0;f<b.length;f++){var j=b[f];e.setAttribute(j.name,j.value)}g&&g.appendChild&&(g.appendChild(e),o.debug.write&&console.log("WRITE start append",e,"to",g)),c||(o.debug.write&&console.log("WRITE push",e,h.slice(0)),h.push(e)),o.debug.write&&console.log("WRITE start done - parent:",g)}},end:function(a){d("end",a)!==!1&&(h.pop(),o.debug.write&&console.log("WRITE end",a,"new parent:",g,"elems",h))},chars:function(b){d("chars",b)!==!1&&(o.debug.write&&console.log("WRITE chars",b,"el:",a),g.appendChild(i.createTextNode(b)))},comment:function(a){d("comment",a)===!1},close:function(){d("close")!==!1&&o.debug.write&&console.log("WRITE close el:",a)},_handle:function(){d.apply(this,arguments)}});return c.writer={handle:function(a,b){j[a]?j[a].apply(j,b||[]):j._handle.apply(j,arguments)},write:function(a){return k.parseMore(a),this},writeln:function(a){return this.write(a+"\n"),this},close:function(a){return k.end(a),j.close(),this}}}function d(a){for(var b={},c=a.split(","),d=0;d<c.length;d++)b[c[d]]=!0;return b}function e(a,b){return Array.prototype.slice.call(a,b)}var f=/^<([\-A-Za-z0-9_]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,g=/^<\/([\-A-Za-z0-9_]+)[^>]*>/,h=/([\-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,i=d("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),j=d("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),k=d("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),l=d("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),m=d("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),n=d("script,style"),o={toElement:c,HTMLParser:b,debug:{parse:!1,write:!1}};a(o)}("function"==typeof define?define:function(a){"object"==typeof exports?module.exports=a:this.elementWrite=a}),function(a){"use strict";function b(a,b){var d,e,g,h,j,k,l=0;return b=b||function(){},d=i.toElement(a,f({start:function(a,b,c,d){if(j)return!1;if("script"===a.toLowerCase())return g="",e=b||{},!1;if(l||/^(object|embed)$/i.test(a)){h=(l?h:"")+"<"+a;for(var f=0;f<b.length;f++)h+=" "+b[f].name+'="'+b[f].escaped+'"';return h+=">",c&&!l?d.stack.last().innerHTML+=h:c||l++,!1}return"noscript"===a.toLowerCase()?(j=!0,!1):("iframe"===a.toLowerCase()&&(k=!0),void 0)},chars:function(a){return l?(h+=a,!1):j?!1:k?!1:e?(g+=a,!1):void 0},end:function(a,b){if(l)return h+="</"+a+">",--l||(b.stack.last().innerHTML+=h),!1;if(j)return j="noscript"!==a.toLowerCase(),!1;if(k&&(k="iframe"!==a.toLowerCase()),e){var f=e;return e=!1,c(g,f,b.stack.last(),d),!1}},comment:function(){return!1},done:b}))}function c(a,c,f,h){function i(){j(),h.handle("resume")}var j,k=b(f,i);h.handle("pause"),setTimeout(function(){j=e(g(f),k),d(a,c,f,function(){k.close()})},25)}function d(a,c,d,e){for(var f,h,i=g(d),j=i.createElement("script"),l=0;l<c.length;l++){var m=c[l];f=m.name,h=m.value,b.fixUrls&&"src"===f&&(h=b.fixUrls(h)),j.setAttribute(f,h)}a&&(k?j.appendChild(i.createTextNode(a)):j.text=a),e&&j.src&&(j.onload=j.onreadystatechange=function(a,b){(b||!j.readyState||/loaded|complete/.test(j.readyState))&&(j.onload=j.onreadystatechange=null,j=void 0,b||e())}),d.appendChild(j),e&&!j.src&&e()}function e(a,b){var c={write:a.write,writeln:a.writeln};return a.write=function(a){b.handle("write",[a])},a.writeln=function(b){a.write(b+"\n")},function(){a.write=c.write,a.writeln=c.writeln}}function f(a){var b,c=[];return l++,{pause:function(){b=!0},resume:function(){for(b=!1;!b&&c.length;){var a=c.shift();this.writer.handle(a[0],a[1])}},start:function(d,e,f,g){return b?(c.push(["start",[d,e,f]]),!1):a.start(d,e,f,g)},chars:function(d,e){return b?(c.push(["chars",[d]]),!1):a.chars(d,e)},end:function(d,e){return b?(c.push(["end",[d]]),!1):a.end(d,e)},comment:function(d,e){return b?(c.push(["comment",[d]]),!1):a.comment(d,e)},write:function(a){return b?(c.push(["write",[a]]),!1):(this.writer.write(a),!1)},close:function(){return b?(c.push(["close",[]]),!1):a.done?a.done():void 0}}}function g(a){return a.ownerDocument||a.getOwnerDocument&&a.getOwnerDocument()}function h(){if(!j){var a=m.shift();if("undefined"==typeof a)return;if("function"==typeof a.el)return a.el(),void 0;j=!0,b(a.el,function(){j=!1,h()}).close(a.html)}}var i,j,k=function(){var a=document.createElement("script"),b="script"+(new Date).getTime(),c=document.documentElement;a.type="text/javascript";try{a.appendChild(document.createTextNode("window."+b+"=1;"))}catch(d){}return c.insertBefore(a,c.firstChild),window[b]?(delete window[b],!0):!1}(),l=0,m=[];b.write=function(a,b){m.push({el:a,html:b}),h()},a(["element.write"],function(a){return i=b.elementWrite=a,b.fixUrls=function(a){return a.replace(/&amp;/g,"&")},b})}("function"==typeof define?define:function(a,b){"object"==typeof exports?module.exports=b(require(a[0])):window.writeCapture=b(window.elementWrite)}),!function(a,b,c){function d(a,c){var d,e=b.createElement(a||"div");for(d in c)e[d]=c[d];return e}function e(a){for(var b=1,c=arguments.length;c>b;b++)a.appendChild(arguments[b]);return a}function f(a,b,c,d){var e=["opacity",b,~~(100*a),c,d].join("-"),f=.01+100*(c/d),g=Math.max(1-(1-a)/b*(100-f),a),h=l.substring(0,l.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return n[e]||(o.insertRule("@"+i+"keyframes "+e+"{"+"0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}"+"100%{opacity:"+g+"}"+"}",o.cssRules.length),n[e]=1),e}function g(a,b){var d,e,f=a.style;if(f[b]!==c)return b;for(b=b.charAt(0).toUpperCase()+b.slice(1),e=0;e<m.length;e++)if(d=m[e]+b,f[d]!==c)return d}function h(a,b){for(var c in b)a.style[g(a,c)||c]=b[c];return a}function i(a){for(var b=1;b<arguments.length;b++){var d=arguments[b];for(var e in d)a[e]===c&&(a[e]=d[e])}return a}function j(a){for(var b={x:a.offsetLeft,y:a.offsetTop};a=a.offsetParent;)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}function k(a){return this.spin?(this.opts=i(a||{},k.defaults,p),void 0):new k(a)}var l,m=["webkit","Moz","ms","O"],n={},o=function(){var a=d("style",{type:"text/css"});return e(b.getElementsByTagName("head")[0],a),a.sheet||a.styleSheet}(),p={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};k.defaults={},i(k.prototype,{spin:function(a){this.stop();var b,c,e=this,f=e.opts,g=e.el=h(d(0,{className:f.className}),{position:f.position,width:0,zIndex:f.zIndex}),i=f.radius+f.length+f.width;if(a&&(a.insertBefore(g,a.firstChild||null),c=j(a),b=j(g),h(g,{left:("auto"==f.left?c.x-b.x+(a.offsetWidth>>1):parseInt(f.left,10)+i)+"px",top:("auto"==f.top?c.y-b.y+(a.offsetHeight>>1):parseInt(f.top,10)+i)+"px"})),g.setAttribute("aria-role","progressbar"),e.lines(g,e.opts),!l){var k=0,m=f.fps,n=m/f.speed,o=(1-f.opacity)/(n*f.trail/100),p=n/f.lines;!function q(){k++;for(var a=f.lines;a;a--){var b=Math.max(1-(k+a*p)%n*o,f.opacity);e.opacity(g,f.lines-a,b,f)}e.timeout=e.el&&setTimeout(q,~~(1e3/m))}()}return e},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=c),this},lines:function(a,b){function c(a,c){return h(d(),{position:"absolute",width:b.length+b.width+"px",height:b.width+"px",background:a,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/b.lines*i+b.rotate)+"deg) translate("+b.radius+"px"+",0)",borderRadius:(b.corners*b.width>>1)+"px"})}for(var g,i=0;i<b.lines;i++)g=h(d(),{position:"absolute",top:1+~(b.width/2)+"px",transform:b.hwaccel?"translate3d(0,0,0)":"",opacity:b.opacity,animation:l&&f(b.opacity,b.trail,i,b.lines)+" "+1/b.speed+"s linear infinite"}),b.shadow&&e(g,h(c("#000","0 0 4px #000"),{top:"2px"})),e(a,e(g,c(b.color,"0 0 1px rgba(0,0,0,.1)")));return a},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}}),function(){function a(a,b){return d("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',b)}var b=h(d("group"),{behavior:"url(#default#VML)"});!g(b,"transform")&&b.adj?(o.addRule(".spin-vml","behavior:url(#default#VML)"),k.prototype.lines=function(b,c){function d(){return h(a("group",{coordsize:j+" "+j,coordorigin:-i+" "+-i}),{width:j,height:j})}function f(b,f,g){e(l,e(h(d(),{rotation:360/c.lines*b+"deg",left:~~f}),e(h(a("roundrect",{arcsize:c.corners}),{width:i,height:c.width,left:c.radius,top:-c.width>>1,filter:g}),a("fill",{color:c.color,opacity:c.opacity}),a("stroke",{opacity:0}))))}var g,i=c.length+c.width,j=2*i,k=2*-(c.width+c.length)+"px",l=h(d(),{position:"absolute",top:k,left:k});if(c.shadow)for(g=1;g<=c.lines;g++)f(g,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(g=1;g<=c.lines;g++)f(g);return e(b,l)},k.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}):l=g(b,"animation")}(),"function"==typeof define&&define.amd?define(function(){return k}):a.Spinner=k}(window,document),function(a,b,c){var d=a.jQuery||a.Zepto||a.ender||a.elo;"undefined"!=typeof module&&module.exports?module.exports=c(d):a[b]=c(d)}(this,"Response",function(a){function b(a){throw new TypeError(a?T+"."+a:T)}function c(a){return"number"==typeof a&&a===a}function d(a){return"string"==typeof a?g(a.split(" ")):eb(a)?g(a):[]}function e(a,b,c){if(null==a)return a;for(var d=0,e=a.length;e>d;)b.call(c||a[d],a[d],d++,a);return a}function f(a,b,c){var d,e=[],f=a.length,g=0;for(b=b||"",c=c||"";f>g;)d=a[g++],null==d||e.push(b+d+c);return e}function g(a,b,c){var d,e,f,g=0,h=0,i=[],j="function"==typeof b;if(!a)return i;for(c=(f=!0===c)?null:c,d=a.length;d>h;h++)e=a[h],f===!(j?b.call(c,e,h,a):b?typeof e===b:e)&&(i[g++]=e);return i}function h(a,b){var d,e;if(!a||!b)return a;if("function"!=typeof b&&c(e=b.length)){for(d=0;e>d;d++)void 0===b[d]||(a[d]=b[d]);a.length>d||(a.length=d)}else for(d in b)ab.call(b,d)&&void 0!==b[d]&&(a[d]=b[d]);return a}function i(a,b,d){return null==a?a:("object"==typeof a&&!a.nodeType&&c(a.length)?e(a,b,d):b.call(d||a,a),a)}function j(a){return function(b,c){var d=a();return b=d>=(b||0),c?b&&c>=d:b}}function k(a){var b=W.devicePixelRatio;return null==a?b||(k(2)?2:k(1.5)?1.5:k(1)?1:0):isFinite(a)?b&&b>0?b>=a:(a="only all and (min--moz-device-pixel-ratio:"+a+")",Bb(a).matches?!0:!!Bb(a.replace("-moz-","")).matches):!1}function l(a){return a.replace(wb,"$1").replace(vb,function(a,b){return b.toUpperCase()})}function m(a){return"data-"+(a?a.replace(wb,"$1").replace(ub,"$1-$2").toLowerCase():a)}function n(a){var b;return a&&"string"==typeof a?"true"===a?!0:"false"===a?!1:"undefined"===a?b:"null"===a?null:(b=parseFloat(a))===+b?b:a:a}function o(a){return a?1===a.nodeType?a:a[0]&&1===a[0].nodeType?a[0]:!1:!1}function p(a,b){var c,d=arguments.length,f=o(this),g={},h=!1;if(d){if(eb(a)&&(h=!0,a=a[0]),"string"==typeof a){if(a=m(a),1===d)return g=f.getAttribute(a),h?n(g):g;if(this===f||2>(c=this.length||1))f.setAttribute(a,b);else for(;c--;)c in this&&p.apply(this[c],arguments)}else if(a instanceof Object)for(c in a)a.hasOwnProperty(c)&&p.call(this,c,a[c]);return this}return f.dataset&&DOMStringMap?f.dataset:(e(f.attributes,function(a){a&&(c=String(a.name).match(wb))&&(g[l(c[1])]=a.value)}),g)}function q(a){return this&&"string"==typeof a&&(a=d(a),i(this,function(b){e(a,function(a){a&&b.removeAttribute(m(a))})})),this}function r(a){return p.apply(a,bb.call(arguments,1))}function s(a,b){return q.call(a,b)}function t(a){for(var b,c=[],d=0,e=a.length;e>d;)(b=a[d++])&&c.push("["+m(b.replace(tb,"").replace(".","\\."))+"]");return c.join()}function u(b){return a(t(d(b)))}function v(){return window.pageXOffset||Y.scrollLeft}function w(){return window.pageYOffset||Y.scrollTop}function x(a,b){var c=a.getBoundingClientRect?a.getBoundingClientRect():{};return b="number"==typeof b?b||0:0,{top:(c.top||0)-b,left:(c.left||0)-b,bottom:(c.bottom||0)+b,right:(c.right||0)+b}}function y(a,b){var c=x(o(a),b);return!!c&&c.right>=0&&c.left<=Cb()}function z(a,b){var c=x(o(a),b);return!!c&&c.bottom>=0&&c.top<=Db()}function A(a,b){var c=x(o(a),b);return!!c&&c.bottom>=0&&c.top<=Db()&&c.right>=0&&c.left<=Cb()}function B(a){var b={img:1,input:1,source:3,embed:3,track:3,iframe:5,audio:5,video:5,script:5},c=b[a.nodeName.toLowerCase()]||-1;return 4>c?c:null!=a.getAttribute("src")?5:-5}function C(a,c,d){var e;return a&&null!=c||b("store"),d="string"==typeof d&&d,i(a,function(a){e=d?a.getAttribute(d):0<B(a)?a.getAttribute("src"):a.innerHTML,null==e?s(a,c):r(a,c,e)}),O}function D(a,b){var c=[];return a&&b&&e(d(b),function(b){c.push(r(a,b))},a),c}function E(a,b){return"string"==typeof a&&"function"==typeof b&&(ib[a]=b,jb[a]=1),O}function F(a){return $.on("resize",a),O}function G(a,b){var c,d,e=zb.crossover;return"function"==typeof a&&(c=b,b=a,a=c),d=a?""+a+e:e,$.on(d,b),O}function H(a){return i(a,function(a){Z(a),F(a)}),O}function I(a){return i(a,function(a){"object"==typeof a||b("create @args");var c,d=xb(P).configure(a),f=d.verge,g=d.breakpoints,h=yb("scroll"),i=yb("resize");g.length&&(c=g[0]||g[1]||!1,Z(function(){function a(){d.reset(),e(d.$e,function(a,b){d[b].decideValue().updateDOM()}).trigger(g)}function b(){e(d.$e,function(a,b){A(d[b].$e,f)&&d[b].updateDOM()})}var g=zb.allLoaded,j=!!d.lazy;e(d.target().$e,function(a,b){d[b]=xb(d).prepareData(a),(!j||A(d[b].$e,f))&&d[b].updateDOM()}),d.dynamic&&(d.custom||ob>c)&&F(a,i),j&&($.on(h,b),d.$e.one(g,function(){$.off(h,b)}))}))}),O}function J(a){return S[T]===O&&(S[T]=U),"function"==typeof a&&a.call(S,O),O}function K(a,b,c){e(["inX","inY","inViewport"],function(d){(c||!b[d])&&(b[d]=function(b,c){return a(g(this,function(a){return!!a&&!c===O[d](a,b)}))})})}function L(a,b){return"function"==typeof a&&a.fn&&((b||void 0===a.fn.dataset)&&(a.fn.dataset=p),(b||void 0===a.fn.deletes)&&(a.fn.deletes=q),K(a,a.fn,b)),O}function M(b,c){return b=arguments.length?b:a,L(b,c)}if("function"!=typeof a)try{console.log("Response was unable to run due to missing dependency.")}catch(N){}var O,P,Q,R,S=this,T="Response",U=S[T],V="init"+T,W=window,X=document,Y=X.documentElement,Z=a.domReady||a,$=a(W),_=W.screen,ab={}.hasOwnProperty,bb=[].slice,cb=[].concat,db=[].map,eb=Array.isArray||function(a){return a instanceof Array},fb=db?function(a,b,c){return db.call(a,b,c)}:function(a,b,c){var d,e=a.length,f=[];for(d=0;e>d;d++)d in a&&(f[d]=b.call(c,a[d],d,a));return f},gb={width:[0,320,481,641,961,1025,1281],height:[0,481],ratio:[1,1.5,2]},hb={},ib={},jb={},kb={all:[]},lb=1,mb=_.width,nb=_.height,ob=mb>nb?mb:nb,pb=mb+nb-ob,qb=function(){return mb},rb=function(){return nb},sb=/[^a-z0-9_\-\.]/gi,tb=/^[\W\s]+|[\W\s]+$|/g,ub=/([a-z])([A-Z])/g,vb=/-(.)/g,wb=/^data-(.+)$/,xb=Object.create||function(a){function b(){}return b.prototype=a,new b},yb=function(a,b){return b=b||T,a.replace(tb,"")+"."+b.replace(tb,"")},zb={allLoaded:yb("allLoaded"),crossover:yb("crossover")},Ab=W.matchMedia||W.msMatchMedia,Bb=Ab||function(){return{}},Cb=function(a,b,c){var d=b.clientWidth,e=a.innerWidth;return c&&e>d&&!0===c("(min-width:"+e+"px)").matches?function(){return a.innerWidth}:function(){return b.clientWidth}}(W,Y,Ab),Db=function(a,b,c){var d=b.clientHeight,e=a.innerHeight;return c&&e>d&&!0===c("(min-height:"+e+"px)").matches?function(){return a.innerHeight}:function(){return b.clientHeight}}(W,Y,Ab);return Q=j(Cb),R=j(Db),hb.band=j(qb),hb.wave=j(rb),P=function(){function c(a){return"string"==typeof a?a.toLowerCase().replace(sb,""):""}var i=zb.crossover,j=Math.min;return{$e:0,mode:0,breakpoints:null,prefix:null,prop:"width",keys:[],dynamic:null,custom:0,values:[],fn:0,verge:null,newValue:0,currValue:1,aka:null,lazy:null,i:0,uid:null,reset:function(){for(var a=this.breakpoints,b=a.length,c=0;!c&&b--;)this.fn(a[b])&&(c=b);return c!==this.i&&($.trigger(i).trigger(this.prop+i),this.i=c||0),this},configure:function(a){h(this,a);var i,k,l,m,n,o=!0,p=this.prop;if(this.uid=lb++,this.verge=isFinite(this.verge)?this.verge:j(ob,500),this.fn=ib[p]||b("create @fn"),"boolean"!=typeof this.dynamic&&(this.dynamic=!("device"===p.substring(0,6))),this.custom=jb[p],k=this.prefix?g(fb(d(this.prefix),c)):["min-"+p+"-"],l=1<k.length?k.slice(1):0,this.prefix=k[0],n=this.breakpoints,eb(n)?(e(n,function(a){if(!a&&0!==a)throw"invalid breakpoint";o=o&&isFinite(a)}),n=o?n.sort(function(a,b){return a-b}):n,n.length||b("create @breakpoints")):n=gb[p]||gb[p.split("-").pop()]||b("create @prop"),this.breakpoints=o?g(n,function(a){return ob>=a}):n,this.keys=f(this.breakpoints,this.prefix),this.aka=null,l){for(m=[],i=l.length;i--;)m.push(f(this.breakpoints,l[i]));this.aka=m,this.keys=cb.apply(this.keys,m)}return kb.all=kb.all.concat(kb[this.uid]=this.keys),this},target:function(){return this.$e=a(t(kb[this.uid])),C(this.$e,V),this.keys.push(V),this},decideValue:function(){for(var a=null,b=this.breakpoints,c=b.length,d=c;null==a&&d--;)this.fn(b[d])&&(a=this.values[d]);return this.newValue="string"==typeof a?a:this.values[c],this},prepareData:function(b){if(this.$e=a(b),this.mode=B(b),this.values=D(this.$e,this.keys),this.aka)for(var c=this.aka.length;c--;)this.values=h(this.values,D(this.$e,this.aka[c]));return this.decideValue()},updateDOM:function(){return this.currValue===this.newValue?this:(this.currValue=this.newValue,0<this.mode?this.$e[0].setAttribute("src",this.newValue):null==this.newValue?this.$e.empty&&this.$e.empty():this.$e.html?this.$e.html(this.newValue):(this.$e.empty&&this.$e.empty(),this.$e[0].innerHTML=this.newValue),this)}}}(),ib.width=Q,ib.height=R,ib["device-width"]=hb.band,ib["device-height"]=hb.wave,ib["device-pixel-ratio"]=k,O={deviceMin:function(){return pb},deviceMax:function(){return ob},noConflict:J,chain:M,bridge:L,create:I,addTest:E,datatize:m,camelize:l,render:n,store:C,access:D,target:u,object:xb,crossover:G,action:H,resize:F,ready:Z,affix:f,sift:g,dpr:k,deletes:s,scrollX:v,scrollY:w,deviceW:qb,deviceH:rb,device:hb,inX:y,inY:z,route:i,merge:h,media:Bb,wave:R,band:Q,map:fb,each:e,inViewport:A,dataset:r,viewportH:Db,viewportW:Cb},Z(function(){var b,c=r(X.body,"responsejs");c&&(b=!!W.JSON&&JSON.parse,b?c=b(c):a.parseJSON&&(c=a.parseJSON(c)),c&&c.create&&I(c.create)),Y.className=Y.className.replace(/(^|\s)(no-)?responsejs(\s|$)/,"$1$3")+" responsejs "}),O});var Breakdancr=function(){function a(){$.fn.reverse=[].reverse,this.processBreakouts=c,this.processStructure=d,this.reparentElements=e,this.init=b}function b(){var a;if("undefined"!=typeof MutationObserver?a=MutationObserver:"undefined"!=typeof WebKitMutationObserver&&(a=WebKitMutationObserver),a){var b=new a(function(){c()}),d=document.getElementsByTagName("BODY")[0],e={childList:!0};b.observe(d,e)}else var f=100,g=0,h=setInterval(function(){c(),g++,g>=f&&clearInterval(h)},100)}function c(a,b){var c="undefined"!=typeof b?b:i,d="undefined"!=typeof a?a:h;$(c).css("margin-top","");var e=$(d),f=$(c);e.length>0?e.each(function(){var a=$(this).offset().top,b=a+$(this).outerHeight();f.each(function(){var c=$(this).css("position");if("fixed"!=c&&"absoulte"!=c){var d=$(this).offset().top,e=d+$(this).outerHeight();if(d>=a&&b>=d||a>=d&&e>=a){var f=b-d+60+"px",g=$(this).css("margin-top"),h=parseInt(f,10)+parseInt(g,10)+"px";$(this).css("margin-top",h)}}$(this).css("opacity",1)})}):f.css("opacity",1)}function d(a){var b=!1,c=[];$.each(a,function(a){c.push(a)}),c.sort(function(a,b){return parseInt(a,10)-parseInt(b,10)}).reverse(),$.each(c,function(c,d){var f=a[d].reflowElements;return f&&Response.band(parseInt(d,10))?(e(f[0],f[1]),b=!0,!1):void 0}),b||e()}function e(a,b){$("[data-marker^=mark]").each(function(){var a=$(this),b=$("#"+a.attr("data-marker"));a.insertAfter(b),a.attr("data-marker",""),b.remove()});var c=f(),d=$(a),e=$(b);"prepend"===c&&d.reverse(),d.length>0&&d.each(function(){if(e.length>0){var a="mark"+Math.round(1e12*Math.random());$(this).attr("data-marker",a),$(this).after($('<span id="'+a+'"></span>')),"prepend"===c?$(this).prependTo(e):$(this).appendTo(e)}})}function f(){return $("body").hasClass("short")?"prepend":!1}var g,h=".breakout, .layout-object.left, .layout-object.xlarge, .say-verso-stripe",i=".reflow";return{name:"Breakdancr",getInstance:function(){return"undefined"==typeof g?g=new a:g}}}();Breakdancr.getInstance().init();var ReadingList=function(){function a(){this.initReadingList=c,this.markArticleAsRead=e}function b(a){var b=a.split("/");if(b.length<5)return!1;var c=parseInt(b[1],10),d=parseInt(b[2],10),e=parseInt(b[3],10);return c>2e3&&d>=1&&12>=d&&e>=1&&32>=e}function c(){function a(a,i,j){var k=h(a.find("A").attr("href"));b(k)&&j>g&&(a.find("A").attr("href",k),i>d&&($img=a.find(".thumb"),$img.data("image-url")&&$img.find("img").attr("src",$img.data("image-url")),0===d?($(".next-unread-link").attr("href",k),$(".next-article .next-unread-link").html(a.find("A").html()),$("#popular-feed > H3").after(a)):$("#popular-feed > :last(ARTICLE)").after(a),f(k)&&(e(k),a.addClass("read"),c++),d++),g++)}var c=0,d=0,g=0;$.get(CoreSettings.readingListingStreamContentURL,function(b){var e=$($.trim(b)),f=$("ARTICLE.view-headline:not(.sponsored-promotional)",e),g=$("SECTION.copy").height()>1100?CoreSettings.unreadArticlesListLength:Math.round(CoreSettings.unreadArticlesListLength/2);f.each(function(){a($(this),g,CoreSettings.readingListLength)});var h=d-c;$(".unread-count").text(h).show();var i=CoreAnalytics.getInstance();$("#popular-feed").find("A").each(function(){i.addTrackingHash(this)}),1>h&&$(".next-article").hide(),$.publish(CoreEvent.ON_LISTING_STREAM_LOADED)})}function d(a){var b,c,d=0;if(0===a.length)return d;for(b=0;b<a.length;b++)c=a.charCodeAt(b),d=(d<<5)-d+c,d&=d;return d}function e(a){var b=g(a),c=$.cookie(CoreData.READ_ARTICLE_LIST_COOKIE)||[],d=$.inArray(b,c);for(-1===d?c.push(b):(c.splice(d,1),c.push(b));c.length>CoreSettings.maxReadArticles;)c.shift();$.cookie(CoreData.READ_ARTICLE_LIST_COOKIE,c,{expires:730})}function f(a){var b=$.cookie(CoreData.READ_ARTICLE_LIST_COOKIE)||[];return-1!==$.inArray(g(a),b)}function g(a){return d(h(a))}function h(a){var b=document.createElement("a");b.href=a;var c=0===b.pathname.indexOf("/")?"":"/";return c+b.pathname}var i;return{name:"ReadingList",getInstance:function(){return"undefined"==typeof i?i=new a:i}}}();ReadingList.getInstance();var CoverLines=function(){function a(){this.squeezeText=b}function b(a){a.each(function(){var a=$(this),b=a.text().length,c=Math.round(b/7);c>=1&&5>c?a.addClass("wordcount-sub-5"):c>=5&&10>c?a.addClass("wordcount-5-10"):c>=10&&20>c?a.addClass("wordcount-10-20"):c>=20&&40>c?a.addClass("wordcount-20-40"):a.addClass("wordcount-over-40")})}var c;return{name:"CoverLines",getInstance:function(){return"undefined"==typeof c?c=new a:c}}}();CoverLines.getInstance();var CoreEvent={ON_ERROR_THROWN:"onCoreErrorThrown",ON_INIT_START:"onCoreInitStart",ON_INIT_DONE:"onCoreInitDone",ON_DOCUMENT_READY:"onCoreDocumentReady",ON_DOCUMENT_SCROLLED:"onCoreDocumentScrolled",ON_WINDOW_RESIZED:"onCoreWindowResized",ON_NAVIGATE_TO_REQUESTED:"onCoreNavigateToRequested",ON_ARTICLE_SMARTFEED_PANEL_OVERLAY_TOGGLED:"onCoreArticleSmartfeedPanelOverlayToggled",ON_ARTICLE_SMARTFEED_PANEL_LOADED:"onCoreArticleSmartfeedLoaded",ON_LISTING_STREAM_LOADED:"onCoreListingStreamLoaded",ON_ARTICLE_LOADED:"onCoreArticleLoaded",ON_SOCIAL_INTERACTION:"onCoreSocialInteraction",ON_ORIENTATION_CHANGED:"onCoreOrientationChanged",ON_INFINITE_CONTENT_LOADER_STARTED:"onCoreInfiniteContentLoaderStarted"},CoreError={GENERIC_ERROR:"coreErrorGeneric",PARSING_LINK:"coreErrorParsingLink",ANALYTICS_NOT_AVAILABLE:"coreErrorAnalyticsNotAvailable",ANALYTICS_INVALID_OBJECT:"coreErrorAnalyticsInvalidObject",ANALYTICS_INVALID_TRACKABLE_REGION:"coreErrorInvalidTrackableRegion",ANALYTICS_MISSING_PARAMS:"coreErrorAnalyticsMissingParams",SOCIAL_NOT_AVAILABLE:"coreErrorSocialNotAvailable",UNKNOWN_SOCIAL_SHARE_METHOD:"unknownSocialShareMethod",INVALID_PAGE_TYPE:"coreErrorInvalidPageType",INFINITE_LOADER_EMPTY_RESPONSE:"coreErrorInfiniteLoaderEmptyResponse",INVALID_DIRECTION:"coreErrorInvalidDirection",INVALID_URL:"coreErrorInvalidURL",INVALID_ARTICLE_SMARTFEED_STATE:"coreInvalidArticleSmartfeedState"},CoreDesktop=function(){"use strict";function a(){this.init=b}function b(){$.subscribe(CoreEvent.ON_DOCUMENT_READY,c),$.subscribe(CoreEvent.ON_DOCUMENT_SCROLLED,m),$.subscribe(CoreEvent.ON_ARTICLE_SMARTFEED_PANEL_LOADED,o),$.subscribe(CoreEvent.ON_LISTING_STREAM_LOADED,p),$.subscribe(CoreEvent.ON_INFINITE_CONTENT_LOADER_STARTED,q),$.subscribe(CoreEvent.ON_ARTICLE_LOADED,r),$.subscribe(CoreEvent.ON_WINDOW_RESIZED,n),u=Categorizr.getInstance(),(u.isBrowserDesktopIE6()||u.isBrowserDesktopIE7()||u.isBrowserDesktopIE8())&&head.js(""===_conf.root?"/core/js/_libs/respond.min.js":_conf.root+"core/js/_libs/respond.min.js")}function c(){log("CoreDesktop: Document ready"),t=Phoenix.getInstance(),t.pageFlavor=CoreData.PAGE_FLAVOR_DESKTOP,e(),d(),t.$$.document.on("keydown",k),t.$$.document.on("mousemove",l)}function d(){t.hijackLinks(t.$$.pageHeader),t.pageType===CoreData.PAGE_TYPE_ARTICLE&&(CoreSettings.isArticleSmartfeedPanelContentScrollerEnabled&&(t.$$.articleSmartfeedPanelContent.css("height",t.windowHeight).on("mousewheel",function(a,b){(b>0&&0===$(this).scrollTop()||0>b&&$(this).scrollTop()===$(this).get(0).scrollHeight-$(this).innerHeight())&&a.preventDefault()}),t.$$.articleSmartfeedPanel.css("position","fixed"),v=t.$$.articleSmartfeedPanelContent.jScrollPane({verticalGutter:0,enableKeyboardNavigation:!1,hideFocus:!0,verticalDragMaxHeight:120}).on("jsp-scroll-y",function(a,b,c,d){d&&t.loadArticleSmartfeedPanel()}).data("jsp"),t.$$.articleSmartfeedController.find("li.show").on("click",i),t.$$.articleSmartfeedController.find("li.prev").on("click",function(){t.navigateToArticle(CoreData.NAVIGATION_DIRECTION_PREVIOUS)
}),t.$$.articleSmartfeedController.find("li.next").on("click",function(){t.navigateToArticle(CoreData.NAVIGATION_DIRECTION_NEXT)}),t.$$.articleSmartfeedPanelHeader.find("span.overlay-close").on("click",i),CoreSettings.isArticleSmartfeedPanelFooterEnabled&&(t.$$.articleSmartfeedPanelFooter.show(),t.$$.articleSmartfeedPanelFooter.find("a.prev").removeAttr("href").on("click",function(){v.scrollByY(t.windowHeight*-.66,!0)}).on("mousedown",function(){h(-60)}),t.$$.articleSmartfeedPanelFooter.find("a.next").removeAttr("href").on("click",function(){v.scrollByY(.66*t.windowHeight,!0)}).on("mousedown",function(){h(60)}))),t.hijackLinks(t.$$.articleContainer),t.setArticleData(),CoreSettings.isArticleSmartfeedEnabled&&t.loadArticleSmartfeedPanel(),$.publish(CoreEvent.ON_ARTICLE_LOADED,[++t.articleLoadCount]))}function e(){t.$$.navbarWrapper.find("li.hoverable").not(".droppable").hover(function(){t.hideDroppedNavbar(!0),t.$$.navbar.addClass("hovered"),$(this).addClass("hovered")},function(){t.hideDroppedNavbar(!0)}),t.$$.navbarWrapper.find("li.droppable").on("click",t.clickTrasher).on("mouseover",function(){G||(G=!0,setTimeout(function(){if(""!==D){t.hideDroppedNavbar(!1),t.navbarDroppedItem=D,t.$$.navbar.addClass("hovered dropped");var a=t.$$.navbarWrapper.find(".droppable."+D),b=t.$$.navbarDrops.find(".drop."+D),c=a.offset();a.addClass("hovered dropped"),b.addClass("dropped"),b.css("left",b.hasClass("right-aligned")?c.left+a.width()-b.width():c.left-1),A=b.height()+K,B=b.offset().left,C=b.offset().left+b.width(),b.find(".facebook-like").find("iframe").each(function(){0===$(this).height()&&$(this).height(61)}),log("CoreDesktop: Navbar showing, drop = "+D)}G=!1},50))}),t.$$.navbarWrapper.find("li.droppable").hover(function(){D=$(this).attr("class").split(" ")[0]},function(){D=""})}function f(){if(t.$$.listingAside&&t.$$.listingStream&&H){var a=t.$$.listingStream.offset().top-t.documentScrollY,b=J>a?J:a;t.$$.listingAside.css("top",b)}}function g(){if(CoreSettings.isArticleSmartfeedEnabled&&t.pageType===CoreData.PAGE_TYPE_ARTICLE&&CoreSettings.isArticleSmartfeedPanelContentScrollerEnabled){var a=K>0?K-30:0,b=L>0?L:20,c=CoreSettings.isArticleSmartfeedPanelFooterEnabled?N:-17,d=4+a,e=-3-a;t.$$.articleSmartfeedPanel.css("top",K+b+t.documentScrollY<K+d?K+d:K+b+t.documentScrollY-5+a);var f=t.windowHeight-t.$$.articleSmartfeedPanel.position().top-M-c-K+t.documentScrollY+d+e;f!==x&&(t.$$.articleSmartfeedPanelContent.css("height",f),x=f);var g=function(){E=!1,v.reinitialise(),t.$$.articleSmartfeedPanelContent.css("width",""),t.$$.articleSmartfeedPanelContent.find("div.jspContainer").css("width",""),t.$$.articleSmartfeedPanelContent.find("div.jspPane").css("width","")};E&&clearTimeout(y),E=!0;var h=u.isBrowserDesktopFirefox()?CoreSettings.articleSmartfeedPanelScrollerRefreshFirefoxDelay:CoreSettings.articleSmartfeedPanelScrollerRefreshDefaultDelay;y=setTimeout(g,h)}}function h(a){z=setInterval(function(){v.scrollByY(a,!0)},100),t.$$.window.on("mouseup",function(){clearInterval(z)})}function i(a){t.pageType===CoreData.PAGE_TYPE_ARTICLE&&CoreSettings.isArticleSmartfeedPanelContentScrollerEnabled&&($.publish(CoreEvent.ON_ARTICLE_SMARTFEED_PANEL_OVERLAY_TOGGLED,[F]),t.$$.articleSmartfeedPanel.toggleClass("article-smartfeed-panel-overlay"),t.$$.articleSmartfeedPanelContent.toggleClass("article-smartfeed-panel-overlay"),t.$$.articleSmartfeedController.toggleClass("article-smartfeed-panel-overlay"),F=!F,v.reinitialise(),t.hideDroppedNavbar(!1),t.scheduleTempBlock(),log("CoreTablet: Toggled article smartfeed panel overlay, it's now "+(F?"active":"inactive"))),t.clickTrasher(a)}function j(){t.pageType===CoreData.PAGE_TYPE_ARTICLE?CoreSettings.isArticleSmartfeedEnabled&&CoreSettings.isArticleSmartfeedPanelContentScrollerEnabled?(F&&t.windowWidth>=CoreSettings.articleSmartfeedPanelOverlayLimit&&i(null),w=t.$$.articleSmartfeedPanelContent.width(),g(),t.calculatePageHeight()):t.$$.main.css("height",Math.max(t.$$.mainContent.height(),t.$$.articleSmartfeedPanel.height())+t.$$.navbar.outerHeight()):t.$$.main.css("height",t.$$.mainContent.height()+t.$$.navbar.outerHeight()),t.hideDroppedNavbar(!1),H=t.$$.listingAside&&t.$$.listingAside.is(":visible"),f(),I=t.$$.listing&&t.$$.listing.is(":visible"),M=t.$$.articleSmartfeedPanelHeader?t.$$.articleSmartfeedPanelHeader.height():0,N=t.$$.articleSmartfeedPanelFooter?t.$$.articleSmartfeedPanelFooter.height():0;var a=t.$$.navbar.is(":visible")?t.$$.navbarWrapper.height():0;K!==a&&(K=a);var b=t.$$.pageHeader.is(":visible")?t.$$.pageHeader.height():0;L!==b&&(L=b),J=K+20}function k(a){switch(a.keyCode){case 74:t.navigateToArticle(CoreData.NAVIGATION_DIRECTION_PREVIOUS,a);break;case 75:t.navigateToArticle(CoreData.NAVIGATION_DIRECTION_NEXT,a);break;case 27:t.hideDroppedNavbar(!1)}}function l(a){if(t.navbarDroppedItem){var b=a.pageY-t.documentScrollY>A+CoreSettings.navbarDropMargin,c=a.pageX<B-CoreSettings.navbarDropMargin,d=a.pageX>C+CoreSettings.navbarDropMargin;(b||c||d)&&t.hideDroppedNavbar(!1)}}function m(a,b,c,d){g(),f(),I&&b>c-d-CoreSettings.infiniteLoaderSpan&&t.loadListingStream()}function n(){j()}function o(){g()}function p(){j()}function q(){j()}function r(){t.$$.articleSmartfeedPanelContentList.find("article.active").length>0&&v.scrollToElement("article.active")}var s,t,u,v,w,x,y,z,A,B,C,D,E=!1,F=!1,G=!1,H=!1,I=!1,J=0,K=0,L=0,M=0,N=0;return{name:"CoreDesktop",getInstance:function(){return"undefined"==typeof s?s=new a:s}}}();CoreDesktop.getInstance().init();var CoreAnalytics=function(){"use strict";function a(){this.init=b,this.addTrackingHash=e}function b(){$.subscribe(CoreEvent.ON_INIT_DONE,c),$.subscribe(CoreEvent.ON_ARTICLE_SMARTFEED_PANEL_LOADED,h),$.subscribe(CoreEvent.ON_LISTING_STREAM_LOADED,h),$.subscribe(CoreEvent.ON_NAVIGATE_TO_REQUESTED,i),$.subscribe(CoreEvent.ON_SOCIAL_INTERACTION,j)}function c(){var a=(new Date).getTime();l=Phoenix.getInstance(),l.$$.trackables=$(".trackable"),log("CoreAnalytics: Adding event tracking bindings");var b={id:l.getHashParam("_tid"),action:l.getHashParam("_tact"),label:l.getHashParam("_tlbl"),value:parseInt(l.getHashParam("_tval"),10),nonInteractive:!1};b.id&&b.action&&b.label&&d(["_trackEvent",b.id,b.action,b.label,b.value,!0]);var c=Categorizr.getInstance();if((c.isBrowserDesktopIE10()||!c.isBrowserDesktopIE())&&!c.isMobile()){var f=l.getHash(document.location.hash);delete f.params._tid,delete f.params._tact,delete f.params._tlbl,delete f.params._tval,l.replaceHash(f),l.$$.trackables.find("a[href]").each(function(){e(this)})}log("CoreAnalytics: Link hijacking and initialization took "+((new Date).getTime()-a)+"ms")}function d(a){var b;return log("CoreAnalytics: Tracking "+a.join(", ")),"object"==typeof _gaq?(_gaq.push(a),b=!0):l.throwError(CoreError.ANALYTICS_NOT_AVAILABLE,"_gaq object is not available"),b}function e(a){var b=l.getHash(a.hash);if("disqus_anchor"===b.root)return!1;var c=new CoreNavigationData($(a).attr("href"),{action:"click",subject:a}),e=f(c);a.hostname!==window.location.hostname?$(a).click(function(){d(["_trackEvent",e.id,e.action,e.label,e.value,!0])}):(b.params._tid=e.id,b.params._tact=e.action,b.params._tval=e.value,b.params._tlbl=e.label,a.hash=l.serializeHash(b)),$(a).addClass("parsed")}function f(a){if(!a.context.event&&!a.context.subject&&!a.context.action)return l.throwError(CoreError.ANALYTICS_MISSING_PARAMS,"_parseNavigationData needs EITHER an event AND action OR a subject AND action (or all 3)"),null;var b=a.context.subject?a.context.subject:a.context.event.target,c=a.context.label?a.context.label:null,d=a.context.action?a.context.action:a.context.event.type;if(0===$(b).length)return l.throwError(CoreError.ANALYTICS_INVALID_OBJECT,"Could not find subject. Needs to be implicit by assigning .trackable to a parent or explicit by passing in the context object."),null;var e=g(b);return 0===e.zone.length?(l.throwError(CoreError.ANALYTICS_INVALID_TRACKABLE_REGION,"Could not find trackable region in subject parent tree. Does the item container have the .trackable class?"),null):{id:a.context.id?a.context.id:e.zoneName,action:a.context.action?a.context.action+" : "+e.name:d+" : "+e.name,label:c?c+e.index:"Position: "+e.index,value:a.context.value?a.context.value:e.index}}function g(a){var b=null,c=null,d=$(a).closest(".trackable"),e=$(a).attr("class"),f=[];if(e&&(e=e.replace(/(?:^| )(trackable|tracked|parsed|first|last)(?:$| )/g,""),f=e.split(/\s+/).filter(function(a){return a.match(/\w+/)})),0===d.length)return l.throwError(CoreError.ANALYTICS_INVALID_TRACKABLE_REGION,"Could not find trackable region in subject parent tree. Does the item container have the .trackable class?"),null;var g=$(d).attr("id")?$(d).attr("id"):$(d).attr("class").replace(/(?:^| )(trackable|tracked|parsed|first|last)(?:$| )/g,"");if($(a).attr("id"))b=$(a).attr("id"),c=-1;else if(f.length>0){if(b=f.join("-"),null===c){var h="a"+f.map(function(a){return"."+a}).join("");c=$(h).index(a)+1}}else{var i=$(a).parent(),j=$(a).closest("li");j.length>0&&(c=j.index()),-1===a&&(c=a.index()),-1===c&&(c=i.index()),b=$(a)[0].tagName,null===c&&(c=$(d).find(a.tagName).index(a)+1)}return{zone:d,name:b,index:c,zoneName:g}}function h(a,b,c,f){if(c&&f){var h=g(f);c>1&&d(["_trackEvent",h.zoneName,"Infinite load","Page "+c,c,!1])}if(window.History.enabled){var i=$(f).find("a").not(".ajax").not(".parsed");i.each(function(){e(this)})}}function i(a,b){if(b.context.event){b.context.subject="IMG"===b.context.event.target.tagName?b.context.event.target:b.context.event.currentTarget;var c=f(b);return d(["_trackEvent",c.id,c.action,c.label,c.value,!0])}}function j(a,b){var c="Not available";b.action=b.action.toLowerCase(),b.medium=b.medium.toLowerCase(),$(b.element).parents().each(function(){var a=$(this).attr("id");return a?(c=a,!1):!0}),log("CoreAnalytics: Tracking social action ("+b.medium+", "+b.action+", "+c+")"),d(["_trackEvent",c,b.action,b.medium,-1,!0]),d(["_trackSocial",b.medium,b.action,window.location.pathname])}var k,l;return{name:"CoreAnalytics",getInstance:function(){return"undefined"==typeof k?k=new a:k}}}();CoreAnalytics.getInstance().init(),Date.prototype.toISOString||(Date.prototype.toISOString=function(){function a(a){return 10>a?"0"+a:a}return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z"});var CoreSocial=function(){"use strict";function a(){this.init=b,this.share=d,this.follow=c}function b(){SiteSettings.isEditorial||(u.$$={},u.articleCountObjects=[],$.subscribe(CoreEvent.ON_DOCUMENT_READY,h),$.subscribe(CoreEvent.ON_LISTING_STREAM_LOADED,function(){t(),n()}))}function c(a,b){w[a]?AWESM.convert(w[a],1):v.throwError(CoreError.UNKNOWN_SOCIAL_SHARE_METHOD,0/0+a+" is not supported by core-social."),v.openLink($(b).attr("data-href"),"_blank")}function d(a,b){var c=l(),d=e(),g=f(),h=r(b);"function"==typeof AWESM.share[a]?AWESM.share[a]({url:c,key:CoreSettings.awesmKey,title:d,text:d,subject:d,tag:h.tag1,tag_2:h.tag2,tag_3:h.tag3,tag_5:h.tag5,notes:h.notes,body:d+" "+g+" "+c}):v.throwError(CoreError.UNKNOWN_SOCIAL_SHARE_METHOD,a+" is not supported by AWESM.share.")}function e(){var a;return a=v.pageType===CoreData.PAGE_TYPE_ARTICLE?""===v.articleData.tweet?v.articleData.title:v.articleData.tweet:document.title}function f(){var a;return a=v.pageType===CoreData.PAGE_TYPE_ARTICLE?v.articleData.nutgraph:""}function g(){v=Phoenix.getInstance(),t(),q()}function h(){window.AWESM={},AWESM.api_key=CoreSettings.awesmKey,AWESM.addressbar=!0,AWESM.appendToHash=!0,head.js("//saywidgets.awe.sm/v3/widgets.js?key="+CoreSettings.awesmKey+"&async=true",g)}function i(a){for(var b,c=["","K","M","B"],d=a,e=0;e<c.length;e++){if(1e3>d){b=Math.round(10*d)/10+c[e];break}d/=1e3}return b}function j(a,b){var c="http://fast.api.awe.sm/stats/totals.json?v=3&per_page="+b+"&pivot=channel"+"&group_by=original_url"+"&key="+CoreSettings.awesmKey+a;return c}function k(a){var b;return b="undefined"==typeof $(a).attr("data-interaction-count")?v.articleData&&v.articleData.interactionCount?v.articleData.interactionCount:0:parseInt($(a).attr("data-interaction-count")),isNaN(b)&&(b=0),b}function l(a){var b;b="undefined"==typeof $(a).attr("data-href")?location.href:$(a).attr("data-href");var c=document.createElement("a");c.href=b;var d=c.pathname;return"/"!==d[0]&&(d="/"+d),b=c.protocol+"//"+c.hostname+d}function m(a){for(var b=0;b<a.groups.length;b++){for(var c=a.groups[b].original_url,d=0,e=0,f=0;f<a.groups[b].pivots.length;f++){var g=a.groups[b].pivots[f].channel;u.articleCountObjects[c][g]=[],a.groups[b].pivots[f].shares&&(u.articleCountObjects[c][g].shares=a.groups[b].pivots[f].shares,d+=a.groups[b].pivots[f].shares),a.groups[b].pivots[f].clicks&&(u.articleCountObjects[c][g].clicks=a.groups[b].pivots[f].clicks,e+=a.groups[b].pivots[f].clicks),a.groups[b].pivots[f].clicks_per_share&&(u.articleCountObjects[c][g].clicks_per_share=a.groups[b].pivots[f].clicks_per_share)}u.articleCountObjects[c].totalClicks=e,u.articleCountObjects[c].totalShares=d,u.articleCountObjects[c].totalInteractions+=e+d}u.$$.interactionCount.not("parsed").each(function(){var a=l(this);if($(this).attr("data-medium")&&u.articleCountObjects[a]&&u.articleCountObjects[a][$(this).attr("data-medium")]){var b=0;u.articleCountObjects[a][$(this).attr("data-medium")].shares&&(b+=u.articleCountObjects[a][$(this).attr("data-medium")].shares),u.articleCountObjects[a][$(this).attr("data-medium")].clicks&&(b+=u.articleCountObjects[a][$(this).attr("data-medium")].clicks),$(this).html(i(b)),$(this).addClass("parsed")}else u.articleCountObjects[a]&&($(this).html(i(u.articleCountObjects[a].totalInteractions)),$(this).addClass("parsed"))})}function n(){var a="",b=0;if(u.$$.interactionCount.not(".parsed").each(function(){var c=l(this),d=k(this);"undefined"==typeof u.articleCountObjects[c]&&(u.articleCountObjects[c]={htmlElems:[]},u.articleCountObjects[c].commentCount=d,u.articleCountObjects[c].totalClicks=0,u.articleCountObjects[c].totalShares=0,u.articleCountObjects[c].totalInteractions=d,$(this).html(d),b++,a+="&original_url[]="+encodeURIComponent(c)),u.articleCountObjects[c].htmlElems.push(this)}),""!=a){var c=j(a,b);$.ajax({cache:"true",jsonpCallback:"awesmStats",dataType:"jsonp",url:c,type:"get",success:m,error:o})}}function o(){u.$$.interactionCount.each(function(){$(this).html("NA")})}function p(a){var b="",c=$(a).closest(".trackable");return c.length>0&&(b=$(c).attr("id")?$(c).attr("id"):$(c).attr("class").replace(/(?:^| )(trackable|tracked|parsed|first|last)(?:$| )/g,"")),b}function q(){CoreSettings.isSocialEnabled?(u.$$.socialWidget.each(function(){"function"==typeof AWESM[$(this).attr("data-action")]&&AWESM[$(this).attr("data-action")]({"data-url":$(this).attr("data-url"),"data-text":$(this).attr("data-text"),"data-via":$(this).attr("data-via"),"data-related":$(this).attr("data-related"),"data-lang":$(this).attr("data-lang"),href:$(this).attr("data-href"),layout:$(this).attr("data-layout"),show_faces:$(this).attr("data-show-faces"),awesm_buttonid:this})}),log("Core: awesm initialized")):v.throwError(CoreError.SOCIAL_NOT_AVAILABLE,"Social disabled"),n(),u.$$.socialCustom.off("click"),u.$$.socialCustom.on("click",function(a){var b=$(a.target),c=b.attr("data-social-action"),d=b.attr("data-medium");u[c]&&"function"==typeof u[c]&&(v.clickTrasher(a),u[c](d,b)),$.publish(CoreEvent.ON_SOCIAL_INTERACTION,[{medium:d,action:c+" : start : custom",url:document.location,element:b}])}),u.$$.socialNative.each(function(){$(this).on("change",function(){s(this)})})}function r(a){var b={tag1:"",tag2:"",tag3:"",tag4:"",tag5:"",notes:"",tagString:""};if(b.notes="location:"+p(a),v&&v.articleData&&(b.tag1=v.articleData.author,b.notes+=";domainId:"+v.articleData.domainId,b.notes+=";contentId:"+v.articleData.contentId,v.articleData.publishedDatestamp)){var c=new Date(1e3*v.articleData.publishedDatestamp);b.tag2=c.toISOString()}return b.tag3=document.referer||"",window.orion&&window.orion.tetrapak&&(b.tag5=window.orion.tetrapak.getSID()),b.tagString="tag="+b.tag1+"&tag_2="+b.tag2+"&tag_3="+b.tag3+"&tag_4="+b.tag4+"&tag_5="+b.tag5+"&notes="+b.notes,b}function s(a){var b=encodeURIComponent(location.href),c=e(),d=f(),g=r(a),h="http://api.awe.sm/url/share?key="+CoreSettings.awesmKey+"&tool="+CoreSettings.awesmTool+"&url="+b+"&v=3"+"&"+g.tagString,i=a.options[a.selectedIndex].value;switch(i){case"fblike":h+="&channel=facebook-share&destination=http://www.facebook.com/sharer.php%3Fu=AWESM_URL";break;case"twitter":h+="&channel=twitter&destination=https://twitter.com/intent/tweet%3Furl=AWESM_URL%26text="+c;break;case"linkedin":h+="&channel=linkedin-share&destination=http://www.linkedin.com/shareArticle%3Fmini=true&url=AWESM_URL%26title="+c+"%26summary="+d;break;case"googleplus":h+="&channel=googleplus&destination=https://plus.google.com/share?url=AWESM_URL";break;case"email":h+="&channel=email&destination=mailto:%3Fsubject="+c+"%26body="+c+d+"AWESM_URL";break;default:v.throwError(CoreError.UNKNOWN_SOCIAL_SHARE_METHOD,i+" is not supported by AWESM.share.")}v.openLink(h,"_blank"),a.selectedIndex=0}function t(){u.$$.socialWidget=$(CoreSettings.$$.socialWidget),u.$$.socialCustom=$(CoreSettings.$$.socialCustom),u.$$.socialNative=$(CoreSettings.$$.socialNative),u.$$.interactionCount=$(CoreSettings.$$.interactionCount)}var u,v,w={twitter:"goal_1",facebook:"goal_2",linkedin:"goal_3",google:"goal_4"};return{name:"CoreSocial",getInstance:function(){return"undefined"==typeof u?u=new a:u}}}();CoreSocial.getInstance().init(),function(){"use strict";function a(){log("SiteDesktop: Document ready"),i||(i=Phoenix.getInstance()),b(),c(),i.$$.window.on("lyraAdLoaded",function(){j.processBreakouts()}),j.processBreakouts(),ReadingList.getInstance().initReadingList()}function b(){i.pageType===CoreData.PAGE_TYPE_HUB&&CoverLines.getInstance().squeezeText($(".coverlines H1"))}function c(){var a=[];$.each(k,function(b){a.push(parseInt(b,10)-l)}),Response.create({prop:"width",prefix:"min-width-",breakpoints:a,lazy:!0}),Response.crossover(function(){j.processStructure(k),j.processBreakouts(),d(),i.pageType===CoreData.PAGE_TYPE_ARTICLE&&AdInstantiater.getInstance().reloadTileAds()},"width"),i.pageType===CoreData.PAGE_TYPE_HUB&&d(),j.processStructure(k)}function d(){if(i.pageType===CoreData.PAGE_TYPE_HUB){var a=[];$.each(k,function(b){a.push(b)}),a.sort(function(a,b){return parseInt(a,10)-parseInt(b,10)}).reverse(),$.each(a,function(a,b){if(Response.band(parseInt(b,10)-l)){var c=k[b].cardBreakpoints;return e(c[0],c[1]),!1}})}}function e(a,b){var c="#lyra_lite",d="#ad-tiles",e="ARTICLE.story",f="#article_list-0",g=$(c),h=$(d),i=0,j=!1,k=!1;$(f).find([e,c,d].join(", ")).each(function(){$(this).is(e)?(i++,a>=i&&j?$(this).insertBefore(g):i>a&&!j?$(this).insertAfter(g):b>=i&&k?$(this).insertBefore(h):i>b&&!k&&$(this).insertAfter(h)):$(this).is(c)?j=!0:$(this).is(d)&&(k=!0)})}function f(){var a="phoenixdev";!function(){var b=document.createElement("script");b.type="text/javascript",b.async=!0,b.src="//"+a+".disqus.com/embed.js?https",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(b)}()}function g(){log("SiteDesktop: Article loaded"),i||(i=Phoenix.getInstance()),i.articleLoadCount>1&&orion.tetrapak.ajaxinit({metadata:{author:i.articleData.author,section:i.articleData.section}}),ReadingList.getInstance().markArticleAsRead(i.articleData.href)}function h(){if(i.pageType===CoreData.PAGE_TYPE_ARTICLE){var a=m.position().top,b=i.$$.window.scrollTop()+i.$$.window.height()+100;b>a&&($.unsubscribe(CoreEvent.ON_DOCUMENT_SCROLLED),f())}}var i,j=Breakdancr.getInstance(),k={0:{cardBreakpoints:[4,8],reflowElements:null},675:{cardBreakpoints:[6,12],reflowElements:null},1080:{cardBreakpoints:[9,18],reflowElements:["#ad-tiles","aside.before"]},1410:{cardBreakpoints:[8,16],reflowElements:null}},l=window.innerWidth-Response.viewportW(),m=$(".page-footer");$.subscribe(CoreEvent.ON_DOCUMENT_READY,a),$.subscribe(CoreEvent.ON_ARTICLE_LOADED,g),$.subscribe(CoreEvent.ON_DOCUMENT_SCROLLED,h)}();var Phoenix=function(){"use strict";function a(){this.pageFlavor=CoreData.PAGE_FLAVOR_BASE,this.orientation=CoreData.ORIENTATION_UNSUPPORTED,this.pageType=CoreData.PAGE_TYPE_UNKNOWN,this.isTempBlockScheduled=!1,this.listingStreamPage=2,this.articleSmartfeedPanelPage=1,this.listingStreamIDList=[],this.articleSmartfeedPanelIDList=[],this.articleSmartfeedPanelSelector=null,this.isDocumentReady=!1,this.documentScrollY=0,this.documentHeight=0,this.windowWidth=0,this.windowHeight=0,this.articleData=null,this.isInfiniteLoaderLoading=!1,this.isInfinteLoaderEOF=!1,this.infiniteLoaderCounter=0,this.infiniteLoadQuery="",this.articleLoadCount=0,this.adReloadTimeout=null,this.isArticleSmartfeedPanelNavigateToNextArticleRequested=!1,this.currentURL=b(document.location),this.bodyScrollTop=0,this.history=window.History,this.navbarDroppedItem=null,this.isArticleSmartfeedPanelFirstLoad=!0,this.hasURLChanged=c,this.stripAnchors=b,this.init=d,this.throwError=i,this.clickTrasher=j,this.scheduleTempBlock=k,this.calculatePageHeight=l,this.addSpinner=m,this.loadInfiniteContent=p,this.loadArticleSmartfeedPanel=n,this.loadListingStream=o,this.triggerWindowResize=z,this.triggerDocumentScroll=A,this.getHashParam=q,this.replaceHash=t,this.getHash=r,this.serializeHash=s,this.refreshDisqus=w,this.refreshOrientation=x,this.setArticleData=v,this.refreshArticleSmartfeedPanelActiveArticle=y,this.openLink=u,this.injectScript=B,this.navigateToArticle=C,this.initLoadArticle=D,this.onHistoryStateChange=N,this.loadArticle=G,this.hideDroppedNavbar=H,this.hijackLinks=I}function b(a){var b=document.createElement("a");return b.href=a,a.protocol+"//"+a.host+a.pathname}function c(){var a=O.stripAnchors(document.location);return a!==O.currentURL}function d(){log("Core: Initialization (running in "+(CoreSettings.isDebugMode?"debug":"release")+" and "+(CoreSettings.isBundleMode?"bundle":"non-bundle")+" modes)"),CoreSettings.isDebugMode||(log=function(){}),$.cookie.json=!0,$.cookie.defaults.path="/",$.subscribe(CoreEvent.ON_ARTICLE_LOADED,M),$.publish(CoreEvent.ON_INIT_START);var a=(new Date).getTime();$("html").addClass(Categorizr.getInstance().getSlugList().join(" ")),e(),f(),g(),h(),O.calculatePageHeight(),$.publish(CoreEvent.ON_DOCUMENT_READY),O.isDocumentReady=!0,O.$$.window.on("statechange",O.onHistoryStateChange),O.triggerWindowResize(),O.triggerDocumentScroll();var b=(new Date).getTime()-a;log("Core: Initialization done ("+b+" ms)"),$.publish(CoreEvent.ON_INIT_DONE,[b])}function e(){O.$$={document:$(document),window:$(window),html:$("html"),body:$("body"),master:$(CoreSettings.$$.master),alpha:$(CoreSettings.$$.alpha),beta:$(CoreSettings.$$.beta),navbar:$(CoreSettings.$$.navbar),navbarWrapper:$(CoreSettings.$$.navbarWrapper),navbarDrops:$(CoreSettings.$$.navbarDrops),navbarDropChannelsG1Panel:$(CoreSettings.$$.navbarDropChannelsG1Panel),navbarDropChannelsG2Panel:$(CoreSettings.$$.navbarDropChannelsG2Panel),navbarDropChannelsG3Panel:$(CoreSettings.$$.navbarDropChannelsG3Panel),navbarDropJustInPanel:$(CoreSettings.$$.navbarDropJustInPanel),navbarDropSearchPanel:$(CoreSettings.$$.navbarDropSearchPanel),navbarDropSubscribePanel:$(CoreSettings.$$.navbarDropSubscribePanel),navbarDropSharePanel:$(CoreSettings.$$.navbarDropSharePanel),navbarPhoneSearch:$(CoreSettings.$$.navbarPhoneSearch),pageHeader:$(CoreSettings.$$.pageHeader),main:$(CoreSettings.$$.main),mainContent:$(CoreSettings.$$.mainContent),mobileAds:$(CoreSettings.$$.mobileAds),swiperContainer:$(CoreSettings.$$.swiperContainer)}}function f(){switch(O.pageType=O.$$.body.hasClass("home")?CoreData.PAGE_TYPE_HOME:O.$$.body.hasClass("layout-hub")?CoreData.PAGE_TYPE_HUB:O.$$.body.hasClass("article")?CoreData.PAGE_TYPE_ARTICLE:CoreData.PAGE_TYPE_BASIC,O.pageType){case CoreData.PAGE_TYPE_HOME:case CoreData.PAGE_TYPE_HUB:O.infiniteLoadQuery=document.location.search.replace(/^\?/,""),O.$$.listing=$(CoreSettings.$$.listing),O.$$.listingStream=$(CoreSettings.$$.listingStream),O.$$.listingAside=$(CoreSettings.$$.listingAside),O.adData=O.$$.listingStream.data("ads")||{};break;case CoreData.PAGE_TYPE_ARTICLE:O.pageType=CoreData.PAGE_TYPE_ARTICLE,O.$$.articleAds=$(CoreSettings.$$.articleAds),O.$$.articleAuthor=$(CoreSettings.$$.articleAuthor),O.$$.articleComments=$(CoreSettings.$$.articleComments),O.$$.articleContainer=$(CoreSettings.$$.articleContainer),O.$$.articleContent=$(CoreSettings.$$.articleContent),O.$$.articleHeader=$(CoreSettings.$$.articleHeader),O.$$.articleNutgraph=$(CoreSettings.$$.articleNutgraph),O.$$.articleRelated=$(CoreSettings.$$.articleRelated),O.$$.articleFader=$(CoreSettings.$$.articleFader),O.$$.articleSmartfeedController=$(CoreSettings.$$.articleSmartfeedController),O.$$.articleSmartfeedPanel=$(CoreSettings.$$.articleSmartfeedPanel),O.$$.articleSmartfeedPanelHeader=$(CoreSettings.$$.articleSmartfeedPanelHeader),O.$$.articleSmartfeedPanelContent=$(CoreSettings.$$.articleSmartfeedPanelContent),O.$$.articleSmartfeedPanelContentList=$(CoreSettings.$$.articleSmartfeedPanelContentList),O.$$.articleSmartfeedPanelFooter=$(CoreSettings.$$.articleSmartfeedPanelFooter),O.$$.articleSocialTop=$(CoreSettings.$$.articleSocialTop),O.$$.articleSocialBottom=$(CoreSettings.$$.articleSocialBottom),O.articleSmartfeedPanelSelector=O.getHashParam("feed")?O.getHashParam("feed").replace(/\/$/,""):!1;var a=O.getHash(document.location.hash);O.infiniteLoadQuery=""===a.query?"":a.query,O.articleData=O.$$.articleContent.data(),log("Core: Article data attributes parsed "+O.articleData),O.adData=O.$$.articleContent.data("ads")||{};var b=Categorizr.getInstance();(b.isBrowserDesktopIE6()||b.isBrowserDesktopIE7())&&(CoreSettings.isArticleSmartfeedPanelContentScrollerEnabled=!1)}}function g(){CoreSettings.isInstapaperDebugMode&&($(".instapaper_title").addClass("debug-instapaper-title"),$(".instapaper_body").addClass("debug-instapaper-body"),$(".instapaper_ignore").addClass("debug-instapaper-ignore"))}function h(){O.$$.window.on("resize",K),O.$$.window.on("orientationchange",L),Categorizr.getInstance().isBrowserDesktopIE8()?$(window).scroll(J):O.$$.document.on("scroll",J)}function i(a,b){log("### Core error: "+a+" ("+b+")"),$.publish(CoreEvent.ON_ERROR_THROWN,[a,b])}function j(a){return a&&a.preventDefault(),a.stopPropagation?a.stopPropagation():window.event&&(window.event.cancelBubble=!0),!1}function k(){(O.pageFlavor===CoreData.PAGE_FLAVOR_TABLET||O.pageFlavor===CoreData.PAGE_FLAVOR_PHONE)&&(log("Core: Resetting temporary navigation blocker"),O.isTempBlockScheduled&&clearTimeout(O.tempBlockTimeout),O.isTempBlockScheduled=!0,P=setTimeout(function(){log("Core: Clearing temporary navigation blocker"),clearTimeout(P),O.isTempBlockScheduled=!1},500))}function l(){O.$$.mainContent.css("min-height",Math.max(O.$$.beta.height(),O.$$.window.height()))}function m(a,b){var c,d=document.getElementById(a);return a&&(c=new Spinner({lines:11,length:0,width:3*b,radius:6*b,color:"#000",speed:1,trail:33,shadow:!1,hwaccel:!0}).spin(d)),c}function n(a){if(CoreSettings.isArticleSmartfeedEnabled&&(a=$.extend({replace:!1},a),a.replace&&(O.articleSmartfeedPanelIDList=[],O.articleSmartfeedPanelPage=1),!O.isInfinteLoaderEOF&&!O.isInfiniteLoaderLoading)){log("Core: Loading more article smartfeed panel items");var b=O.$$.articleSmartfeedPanelContentList,c=CoreSettings.articleSmartfeedPanelContentFilter,d=O.articleSmartfeedPanelIDList,e=CoreSettings.articleSmartfeedPanelContentURL+(O.articleSmartfeedPanelSelector?O.articleSmartfeedPanelSelector:"")+"?page="+O.articleSmartfeedPanelPage+"&count="+CoreSettings.articleSmartfeedPanelContentCount+(O.infiniteLoadQuery?"&"+O.infiniteLoadQuery:"");"object"==typeof a.data&&(e+="&"+$.param(a.data)),O.loadInfiniteContent(b,a.replace,e,c,d,O.articleSmartfeedPanelPage,function(a,b,c){return O.pageType!==CoreData.PAGE_TYPE_ARTICLE?(O.throwError(CoreError.INVALID_PAGE_TYPE,"Invalid page type for article loading (should be '"+CoreData.PAGE_TYPE_ARTICLE+"', but it's '"+O.pageType+"')"),void 0):(O.hijackLinks(O.$$.articleSmartfeedPanelContentList),O.$$.articleSmartfeedPanelContentList.find("a.ajax.article").on("click",function(){if(O.pageFlavor===CoreData.PAGE_FLAVOR_DESKTOP||(O.pageFlavor===CoreData.PAGE_FLAVOR_PHONE||O.pageFlavor===CoreData.PAGE_FLAVOR_TABLET)&&!O.isTempBlockScheduled){var a=$(this).parent().data("id");a&&O.refreshArticleSmartfeedPanelActiveArticle(a)}}),O.isArticleSmartfeedPanelFirstLoad&&(O.refreshArticleSmartfeedPanelActiveArticle(null),$(CoreSettings.articleSmartfeedPanelHeaderTitleSelector).text(a?a:"")),O.isArticleSmartfeedPanelNavigateToNextArticleRequested&&(O.isArticleSmartfeedPanelNavigateToNextArticleRequested=!1,O.navigateToArticle(CoreData.NAVIGATION_DIRECTION_NEXT)),$.publish(CoreEvent.ON_ARTICLE_SMARTFEED_PANEL_LOADED,[a,b,c]),void 0)}),O.articleSmartfeedPanelPage++,log("Core: Article smartfeed panel is now on page "+O.articleSmartfeedPanelPage)}}function o(a){if(a=$.extend({replace:!1},a),a.replace&&(O.listingStreamIDList=[],O.listingStreamPage=1),!O.isInfinteLoaderEOF&&!O.isInfiniteLoaderLoading){log("Core: Loading more articles into the listing stream");var b=O.$$.listingStream.find("#article_list-0 > .pane-content"),c=CoreSettings.listingStreamContentFilter,d=O.listingStreamIDList,e=CoreSettings.listingStreamContentURL+("/"===document.location.pathname?"":document.location.pathname.replace(/\/$/,""))+"?page="+O.listingStreamPage+"&count="+CoreSettings.listingStreamCount+(O.infiniteLoadQuery?"&"+O.infiniteLoadQuery:"");"object"==typeof a.data&&(e+="&"+$.param(a.data)),O.loadInfiniteContent(b,a.replace,e,c,d,O.listingStreamPage,function(a,b,c){$.publish(CoreEvent.ON_LISTING_STREAM_LOADED,[a,b,c])}),O.listingStreamPage++,log("Core: Listing stream is now on page "+O.listingStreamPage)}}function p(a,b,c,d,e,f,g){O.isInfiniteLoaderLoading=!0,b&&(O.infiniteLoaderCounter=0,O.isInfinteLoaderEOF=!1,$(a).html(""));var h="spinner-"+O.infiniteLoaderCounter++;a.append($('<div id="'+h+'" class="spinner-container">'));var i=O.addSpinner(h,1);$.publish(CoreEvent.ON_INFINITE_CONTENT_LOADER_STARTED),$.get(c,function(b){i.stop(),$("#"+h).remove();var c=$($.trim(b)).find(d),j=c.parent().attr("data-feed-title"),k=0;0===c.length?O.throwError(CoreError.INFINITE_LOADER_EMPTY_RESPONSE,"Infinite loader did not find any elements matching the filter with '"+d+"'"):c.each(function(){var b=$(this).attr("data-id");$(this).hasClass("ad")?("object"==typeof vetids&&vetids.splice(0,vetids.length-5e3),a.append(this),O.injectScript($(this).attr("id"),$(this).attr("data-scriptsrc"))):b&&-1===$.inArray(b,e)?(e.push(b),a.append(this),k++):b?log("Core: Skipping over infinite loader item id '"+b+"'"):a.append(this)}),0===k?(log("Core: End of infinite loader feed"),O.isInfinteLoaderEOF=!0):(g(j,f,a),"object"==typeof DISQUSWIDGETS&&DISQUSWIDGETS.getCount()),O.isInfiniteLoaderLoading=!1})}function q(a){var b=O.getHash(document.location.hash);return b.params[a]||!1}function r(a){for(var b="string"==typeof a?a.replace(/^#+/,""):"",c=b.split("?"),d=c[0],e=c[1]?c[1]:"",f=d.split(/&/),g="",h={},i=0;i<f.length;i++){var j=f[i].split("=");j.length>1?h[j[0]]=decodeURIComponent(j[1]):g=f[i]}return{root:g,params:h,query:e}}function s(a){var b=$.param(a.params),c="";a.root&&(c="&");var d=a.root+(b?c+b:"")+(a.query?"?"+a.query:"");return d?"#"+d:""}function t(a){var b=s(a),c=document.location.protocol+"//"+document.location.hostname+document.location.pathname+document.location.search+b;window.History.enabled?(log("Core: Changing history state to "+c),window.History.replaceState(null,document.title,c)):(log("Core: History not editable, running location.replace"),location.replace(c))}function u(a,b){var c=document.createElement("a");if(c.href=a,b||(b=c.hostname===window.location.hostname?"":"_blank"),c.target=b,c.style.display="none",document.body.appendChild(c),"object"==typeof c.click)c.click();else if(document.createEvent){var d=document.createEvent("MouseEvents");d.initEvent("click",!0,!0),c.dispatchEvent(d)}document.body.removeChild(c)}function v(){if(O.pageType===CoreData.PAGE_TYPE_ARTICLE){window.document.title=O.articleData.pageTitle?O.articleData.pageTitle:O.articleData.title,$("meta[name=description]").attr("content",O.articleData.dek),$("meta[name=author]").attr("content",O.articleData.author),$("meta[name=twitter\\:title]").attr("content",O.articleData.link),$("meta[name=twitter\\:url]").attr("content",O.articleData.link),$("meta[name=twitter\\:description]").attr("content",O.articleData.dek),$("meta[name=twitter\\:image]").attr("content",O.articleData.image),O.pageFlavor!==CoreData.PAGE_FLAVOR_PHONE&&(O.$$.navbarDropSharePanel.find(".intro").text(O.articleData.title),O.$$.navbarDropSharePanel.find(".thumb").find("img").attr("src",O.articleData.image),O.$$.navbarDropSharePanel.find("p.description").text(O.articleData.dek));
var a=O.$$.pageHeader.find(".section-title");a.text()!==O.articleData.section&&a.delay(500).fadeOut(250,function(){$(this).text(O.articleData.section).fadeIn(250).closest("a").attr("href","/"+O.articleData.section)})}}function w(){"undefined"!=typeof DISQUS&&O.pageType===CoreData.PAGE_TYPE_ARTICLE&&(log("Core: Reloading Disqus: "+location.pathname),DISQUS.reset({reload:!0,config:function(){"string"==typeof disqus_identifier&&""!==disqus_identifier&&(this.page.identifier=disqus_identifier),"string"==typeof disqus_url&&(this.page.url=disqus_url|window.location.href)}}))}function x(){switch(window.orientation){case 0:case 180:O.orientation=CoreData.ORIENTATION_PORTRAIT;break;case 90:case-90:O.orientation=CoreData.ORIENTATION_LANDSCAPE;break;default:O.orientation=CoreData.ORIENTATION_UNSUPPORTED}log("Core: Orientation is now '"+O.orientation+"'")}function y(a){O.pageType===CoreData.PAGE_TYPE_ARTICLE&&(O.$$.articleSmartfeedPanelContentList.find("article").removeClass("active"),null===a&&(a=O.articleData.id),O.$$.articleSmartfeedPanelContentList.find('article[data-id*="'+a+'"]').addClass("active"))}function z(){O.$$.window.trigger("resize")}function A(){O.$$.document.trigger("scroll")}function B(a,b){var c=document.getElementById(a),d=document.createElement("script");d.async=!0,d.src=b+Math.random(),c&&c.appendChild(d)}function C(a,b){if(O.pageType===CoreData.PAGE_TYPE_ARTICLE){var c=O.$$.articleSmartfeedPanelContent.find("article.active").first();if(1===c.length){switch(a){case CoreData.NAVIGATION_DIRECTION_PREVIOUS:if(c.index()>0)do c=c.prev();while(c.hasClass("daybreak"));break;case CoreData.NAVIGATION_DIRECTION_NEXT:do c=c.next();while(c.hasClass("daybreak"));c.hasClass("spinner-container")&&(O.isArticleSmartfeedPanelNavigateToNextArticleRequested=!0,O.loadArticleSmartfeedPanel(),c=null);break;default:return O.throwError(CoreError.INVALID_DIRECTION,"Invalid direction when navigating to an article ('"+a+"')"),void 0}if(c){var d=c.find("a").first().attr("href");O.initLoadArticle(new CoreNavigationData(d,{event:b}))}}else O.throwError(CoreError.INVALID_ARTICLE_SMARTFEED_STATE,"Invalid article smartfeed state - "+c.length+" items active, should be 1")}else O.throwError(CoreError.INVALID_PAGE_TYPE,"Invalid page type for article loading (should be '"+CoreData.PAGE_TYPE_ARTICLE+"', but it's '"+O.pageType+"')")}function D(a){""===a.url||null===a.url||void 0===a.url?O.throwError(CoreError.INVALID_URL,"Invalid URL when navigating to an article"):(O.bodyScrollTop=O.documentScrollY,O.isArticleSmartfeedPanelFirstLoad=!1,O.history.pushState(null,null,a.url),$.publish(CoreEvent.ON_NAVIGATE_TO_REQUESTED,[a]))}function E(a){O.$$.articleFader.hide().fadeIn(150,function(){var b=O.addSpinner("article-fader-spinner",2);O.$$.articleContainer.load(a,function(){O.articleData=O.$$.articleContainer.find("article").data(),O.setArticleData(),O.calculatePageHeight(),O.refreshArticleSmartfeedPanelActiveArticle(null);var a=O.$$.pageHeader.height()-10;O.bodyScrollTop>a&&(O.$$.html.scrollTop(a),O.$$.body.scrollTop(a),O.bodyScrollTop=a),O.$$.articleFader.delay(100).fadeOut(250,function(){b.stop()}),$.publish(CoreEvent.ON_ARTICLE_LOADED,[++O.articleLoadCount])})})}function F(a){O.$$.articleFader.show();var b=O.addSpinner("article-fader-spinner",2);O.$$.articleContainer.load(a,function(){O.calculatePageHeight(),O.setArticleData(),O.refreshArticleSmartfeedPanelActiveArticle(null);var a=O.$$.pageHeader.height();O.bodyScrollTop>a&&(O.$$.body.scrollTop(a),O.bodyScrollTop=a),O.$$.articleFader.hide(),b.stop(),$.publish(CoreEvent.ON_ARTICLE_LOADED,[++O.articleLoadCount])})}function G(a){if(O.pageType!==CoreData.PAGE_TYPE_ARTICLE)return O.throwError(CoreError.INVALID_PAGE_TYPE,"Invalid page type for article loading (should be '"+CoreData.PAGE_TYPE_ARTICLE+"', but it's '"+O.pageType+"')"),void 0;if("undefined"==typeof a.url)return O.throwError(CoreError.PARSING_LINK,"Error parsing link URL"),void 0;var b=CoreSettings.articleURL+window.location.pathname+window.location.search+window.location.hash;switch(O.pageFlavor){case CoreData.PAGE_FLAVOR_DESKTOP:E(b);break;case CoreData.PAGE_FLAVOR_TABLET:F(b)}}function H(a){(O.navbarDroppedItem||a)&&(O.$$.navbar.removeClass("hovered dropped"),O.$$.navbarWrapper.find(".droppable").removeClass("dropped"),O.$$.navbarWrapper.find(".hoverable").removeClass("hovered"),O.$$.navbarDrops.find(".drop").removeClass("dropped"),O.navbarDroppedItem=null,log("Core: Navbar hidden"))}function I(a){a&&O.history.enabled&&(a.find("a.ajax.article").not(".parsed").addClass("parsed").on("click",function(a){if(O.clickTrasher(a),O.isTempBlockScheduled)log("Core: Temporary blocker scheduled (ignoring accidental tap)");else{switch(O.pageFlavor){case CoreData.PAGE_FLAVOR_PHONE:case CoreData.PAGE_FLAVOR_TABLET:O.scheduleTempBlock();break;default:O.clickTrasher(a)}O.initLoadArticle(new CoreNavigationData($(this).attr("href"),{event:a}))}}),O.pageFlavor!==CoreData.PAGE_FLAVOR_DESKTOP&&a.find("a").not(".parsed").addClass("parsed").on("click",function(a){O.isTempBlockScheduled?(log("Core: Temporary blocker scheduled (ignoring accidental tap)"),O.clickTrasher(a)):O.scheduleTempBlock()}))}function J(){if(O.isDocumentReady){O.documentScrollY=O.$$.document.scrollTop(),O.documentHeight=O.$$.document.height();var a=O.documentHeight-O.windowHeight;O.documentScrollY<0&&(O.documentScrollY=0),O.documentScrollY>a&&(O.documentScrollY=a),$.publish(CoreEvent.ON_DOCUMENT_SCROLLED,[O.documentScrollY,O.documentHeight,O.windowHeight])}}function K(){O.isDocumentReady&&(O.windowWidth=O.$$.window.width(),O.windowHeight=O.$$.window.height(),$.publish(CoreEvent.ON_WINDOW_RESIZED,[O.windowWidth,O.windowHeight]))}function L(){O.refreshOrientation(),O.refreshDisqus(),$.publish(CoreEvent.ON_ORIENTATION_CHANGED,[O.orientation])}function M(a,b){try{O.$$.articleContent.fitVids(),b>1&&(O.refreshDisqus(),O.adReloadTimeout&&clearTimeout(O.adReloadTimeout),O.adReloadTimeout=setTimeout(O.loadAds,3e3))}catch(c){O.throwError(CoreError.GENERIC_ERROR,"A generic error occurred: '"+c+"'")}}function N(){O.pageType===CoreData.PAGE_TYPE_ARTICLE&&O.isArticleSmartfeedPanelFirstLoad===!1&&O.hasURLChanged()===!0&&(O.currentURL=O.stripAnchors(document.location),O.loadArticle(new CoreNavigationData(O.history.getState().url)))}var O,P;return{name:"Core",getInstance:function(){return"undefined"==typeof O?O=new a:O},navigateToPreviousArticle:function(){O.navigateToArticle(CoreData.NAVIGATION_DIRECTION_PREVIOUS)},navigateToNextArticle:function(){O.navigateToArticle(CoreData.NAVIGATION_DIRECTION_NEXT)},updateSmartfeed:function(a){O.loadArticleSmartfeedPanel(a)},updateListingStream:function(a){O.loadListingStream(a)}}}();$(document).ready(function(){"use strict";Phoenix.getInstance().init();try{}catch(a){try{console.error("Core: Critical error: "+a)}catch(b){}var c=document.createElement("link");c.type="text/css",c.rel="stylesheet",c.href=""===_conf.root?"/site/css/noscript.css":_conf.root+"site/css/noscript.css",document.getElementsByTagName("head")[0].appendChild(c)}});